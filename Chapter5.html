<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ç¬¬äº”ç« ï¼šä¼˜åŒ–ç®—æ³•ä¸è®­ç»ƒæŠ€å·§ (Optimization &amp; Training Tricks) â€“ æ·±åº¦å­¦ä¹ å®Œæ•´æ•™ç¨‹</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter6.html" rel="next">
<link href="./Chapter4.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5ea8f22911a6df30576a2a25a24cdd7a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter5.html">ç¬¬äºŒéƒ¨åˆ†ï¼šè¿›é˜¶ç¯‡</a></li><li class="breadcrumb-item"><a href="./Chapter5.html"><span class="chapter-title">ç¬¬äº”ç« ï¼šä¼˜åŒ–ç®—æ³•ä¸è®­ç»ƒæŠ€å·§ (Optimization &amp; Training Tricks)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">æ·±åº¦å­¦ä¹ å®Œæ•´æ•™ç¨‹</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ğŸ“‹ è¯¾ç¨‹æ•´ä½“æ¡†æ¶</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€ç¯‡</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">æœºå™¨å­¦ä¹ å®Œæ•´è¯¾ç¨‹</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬äºŒç« ï¼šå›å½’ (Regression)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬ä¸‰ç« ï¼šåˆ†ç±»ä¸é€»è¾‘å›å½’ (Classification &amp; Logistic Regression)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬å››ç« ï¼šæ·±åº¦ç¥ç»ç½‘ç»œåŸºç¡€ (Deep Neural Networks)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">ç¬¬äºŒéƒ¨åˆ†ï¼šè¿›é˜¶ç¯‡</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter5.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">ç¬¬äº”ç« ï¼šä¼˜åŒ–ç®—æ³•ä¸è®­ç»ƒæŠ€å·§ (Optimization &amp; Training Tricks)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter6.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬å…­ç« ï¼šå·ç§¯ç¥ç»ç½‘ç»œ (Convolutional Neural Networks)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬ä¸ƒç« ï¼šå¾ªç¯ç¥ç»ç½‘ç»œ (Recurrent Neural Networks)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬å…«ç« ï¼šAttention ä¸ Transformer</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®è·µä¸åº”ç”¨</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter9.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬ä¹ç« ï¼šè¿ç§»å­¦ä¹ ä¸å¾®è°ƒ (Transfer Learning &amp; Fine-tuning)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter10.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬åç« ï¼šå¼ºåŒ–å­¦ä¹  (Reinforcement Learning)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter11.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬åä¸€ç« ï¼šæ— ç›‘ç£å­¦ä¹  (Unsupervised Learning)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter12.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬åäºŒç« ï¼šå¯è§£é‡Šæ€§ä¸å¯¹æŠ—æ”»å‡»</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter13.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬åä¸‰ç« ï¼šå¤§è¯­è¨€æ¨¡å‹æ—¶ä»£</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ç« èŠ‚ç›®æ ‡" id="toc-ç« èŠ‚ç›®æ ‡" class="nav-link active" data-scroll-target="#ç« èŠ‚ç›®æ ‡">ğŸ“Œ ç« èŠ‚ç›®æ ‡</a></li>
  <li><a href="#æ¢¯åº¦ä¸‹é™çš„å˜ç§" id="toc-æ¢¯åº¦ä¸‹é™çš„å˜ç§" class="nav-link" data-scroll-target="#æ¢¯åº¦ä¸‹é™çš„å˜ç§">5.1 æ¢¯åº¦ä¸‹é™çš„å˜ç§</a>
  <ul class="collapse">
  <li><a href="#ä¸‰ç§æ¢¯åº¦ä¸‹é™" id="toc-ä¸‰ç§æ¢¯åº¦ä¸‹é™" class="nav-link" data-scroll-target="#ä¸‰ç§æ¢¯åº¦ä¸‹é™">ğŸ”„ ä¸‰ç§æ¢¯åº¦ä¸‹é™</a></li>
  <li><a href="#å®ç°-mini-batch" id="toc-å®ç°-mini-batch" class="nav-link" data-scroll-target="#å®ç°-mini-batch">ğŸ’» å®ç° Mini-batch</a></li>
  </ul></li>
  <li><a href="#åŠ¨é‡æ³•-momentum" id="toc-åŠ¨é‡æ³•-momentum" class="nav-link" data-scroll-target="#åŠ¨é‡æ³•-momentum">5.2 åŠ¨é‡æ³• (Momentum)</a>
  <ul class="collapse">
  <li><a href="#é—®é¢˜æ¢¯åº¦ä¸‹é™çš„éœ‡è¡" id="toc-é—®é¢˜æ¢¯åº¦ä¸‹é™çš„éœ‡è¡" class="nav-link" data-scroll-target="#é—®é¢˜æ¢¯åº¦ä¸‹é™çš„éœ‡è¡">ğŸ¯ é—®é¢˜ï¼šæ¢¯åº¦ä¸‹é™çš„éœ‡è¡</a></li>
  <li><a href="#åŠ¨é‡æ³•åŸç†" id="toc-åŠ¨é‡æ³•åŸç†" class="nav-link" data-scroll-target="#åŠ¨é‡æ³•åŸç†">ğŸ’¡ åŠ¨é‡æ³•åŸç†</a></li>
  <li><a href="#æ•ˆæœå¯¹æ¯”" id="toc-æ•ˆæœå¯¹æ¯”" class="nav-link" data-scroll-target="#æ•ˆæœå¯¹æ¯”">ğŸ“Š æ•ˆæœå¯¹æ¯”</a></li>
  <li><a href="#å®ç°" id="toc-å®ç°" class="nav-link" data-scroll-target="#å®ç°">ğŸ’» å®ç°</a></li>
  </ul></li>
  <li><a href="#rmsprop-root-mean-square-propagation" id="toc-rmsprop-root-mean-square-propagation" class="nav-link" data-scroll-target="#rmsprop-root-mean-square-propagation">5.3 RMSprop (Root Mean Square Propagation)</a>
  <ul class="collapse">
  <li><a href="#é—®é¢˜ä¸åŒå‚æ•°éœ€è¦ä¸åŒå­¦ä¹ ç‡" id="toc-é—®é¢˜ä¸åŒå‚æ•°éœ€è¦ä¸åŒå­¦ä¹ ç‡" class="nav-link" data-scroll-target="#é—®é¢˜ä¸åŒå‚æ•°éœ€è¦ä¸åŒå­¦ä¹ ç‡">ğŸ¯ é—®é¢˜ï¼šä¸åŒå‚æ•°éœ€è¦ä¸åŒå­¦ä¹ ç‡</a></li>
  <li><a href="#rmsprop-åŸç†" id="toc-rmsprop-åŸç†" class="nav-link" data-scroll-target="#rmsprop-åŸç†">ğŸ’¡ RMSprop åŸç†</a></li>
  <li><a href="#å®ç°-1" id="toc-å®ç°-1" class="nav-link" data-scroll-target="#å®ç°-1">ğŸ’» å®ç°</a></li>
  </ul></li>
  <li><a href="#adam-adaptive-moment-estimation" id="toc-adam-adaptive-moment-estimation" class="nav-link" data-scroll-target="#adam-adaptive-moment-estimation">5.4 Adam (Adaptive Moment Estimation) â­</a>
  <ul class="collapse">
  <li><a href="#adam-momentum-rmsprop" id="toc-adam-momentum-rmsprop" class="nav-link" data-scroll-target="#adam-momentum-rmsprop">ğŸ¯ Adam = Momentum + RMSprop</a></li>
  <li><a href="#ç®—æ³•" id="toc-ç®—æ³•" class="nav-link" data-scroll-target="#ç®—æ³•">ğŸ“ ç®—æ³•</a></li>
  <li><a href="#ä¸ºä»€ä¹ˆéœ€è¦åå·®ä¿®æ­£" id="toc-ä¸ºä»€ä¹ˆéœ€è¦åå·®ä¿®æ­£" class="nav-link" data-scroll-target="#ä¸ºä»€ä¹ˆéœ€è¦åå·®ä¿®æ­£">ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦åå·®ä¿®æ­£ï¼Ÿ</a></li>
  <li><a href="#å®Œæ•´å®ç°" id="toc-å®Œæ•´å®ç°" class="nav-link" data-scroll-target="#å®Œæ•´å®ç°">ğŸ’» å®Œæ•´å®ç°</a></li>
  </ul></li>
  <li><a href="#ä¼˜åŒ–å™¨å¯¹æ¯”" id="toc-ä¼˜åŒ–å™¨å¯¹æ¯”" class="nav-link" data-scroll-target="#ä¼˜åŒ–å™¨å¯¹æ¯”">5.5 ä¼˜åŒ–å™¨å¯¹æ¯”</a>
  <ul class="collapse">
  <li><a href="#å¯è§†åŒ–å¯¹æ¯”" id="toc-å¯è§†åŒ–å¯¹æ¯”" class="nav-link" data-scroll-target="#å¯è§†åŒ–å¯¹æ¯”">ğŸ“Š å¯è§†åŒ–å¯¹æ¯”</a></li>
  <li><a href="#æ€§èƒ½å¯¹æ¯”è¡¨" id="toc-æ€§èƒ½å¯¹æ¯”è¡¨" class="nav-link" data-scroll-target="#æ€§èƒ½å¯¹æ¯”è¡¨">ğŸ“ˆ æ€§èƒ½å¯¹æ¯”è¡¨</a></li>
  <li><a href="#é€‰æ‹©æŒ‡å—" id="toc-é€‰æ‹©æŒ‡å—" class="nav-link" data-scroll-target="#é€‰æ‹©æŒ‡å—">ğŸ’¡ é€‰æ‹©æŒ‡å—</a></li>
  </ul></li>
  <li><a href="#å­¦ä¹ ç‡è°ƒåº¦-learning-rate-scheduling" id="toc-å­¦ä¹ ç‡è°ƒåº¦-learning-rate-scheduling" class="nav-link" data-scroll-target="#å­¦ä¹ ç‡è°ƒåº¦-learning-rate-scheduling">5.6 å­¦ä¹ ç‡è°ƒåº¦ (Learning Rate Scheduling)</a>
  <ul class="collapse">
  <li><a href="#ä¸ºä»€ä¹ˆéœ€è¦è°ƒæ•´å­¦ä¹ ç‡" id="toc-ä¸ºä»€ä¹ˆéœ€è¦è°ƒæ•´å­¦ä¹ ç‡" class="nav-link" data-scroll-target="#ä¸ºä»€ä¹ˆéœ€è¦è°ƒæ•´å­¦ä¹ ç‡">ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦è°ƒæ•´å­¦ä¹ ç‡ï¼Ÿ</a></li>
  <li><a href="#å¸¸è§è°ƒåº¦ç­–ç•¥" id="toc-å¸¸è§è°ƒåº¦ç­–ç•¥" class="nav-link" data-scroll-target="#å¸¸è§è°ƒåº¦ç­–ç•¥">ğŸ“Š å¸¸è§è°ƒåº¦ç­–ç•¥</a></li>
  <li><a href="#å¯è§†åŒ–å¯¹æ¯”-1" id="toc-å¯è§†åŒ–å¯¹æ¯”-1" class="nav-link" data-scroll-target="#å¯è§†åŒ–å¯¹æ¯”-1">ğŸ“ˆ å¯è§†åŒ–å¯¹æ¯”</a></li>
  </ul></li>
  <li><a href="#æ­£åˆ™åŒ–æŠ€æœ¯-regularization" id="toc-æ­£åˆ™åŒ–æŠ€æœ¯-regularization" class="nav-link" data-scroll-target="#æ­£åˆ™åŒ–æŠ€æœ¯-regularization">5.7 æ­£åˆ™åŒ–æŠ€æœ¯ (Regularization)</a>
  <ul class="collapse">
  <li><a href="#é—®é¢˜è¿‡æ‹Ÿåˆ" id="toc-é—®é¢˜è¿‡æ‹Ÿåˆ" class="nav-link" data-scroll-target="#é—®é¢˜è¿‡æ‹Ÿåˆ">ğŸ¯ é—®é¢˜ï¼šè¿‡æ‹Ÿåˆ</a></li>
  <li><a href="#l1-å’Œ-l2-æ­£åˆ™åŒ–" id="toc-l1-å’Œ-l2-æ­£åˆ™åŒ–" class="nav-link" data-scroll-target="#l1-å’Œ-l2-æ­£åˆ™åŒ–">ğŸ”¹ L1 å’Œ L2 æ­£åˆ™åŒ–</a></li>
  <li><a href="#dropout" id="toc-dropout" class="nav-link" data-scroll-target="#dropout">ğŸ”¹ Dropout â­</a></li>
  <li><a href="#dropout-æ•ˆæœ" id="toc-dropout-æ•ˆæœ" class="nav-link" data-scroll-target="#dropout-æ•ˆæœ">ğŸ“Š Dropout æ•ˆæœ</a></li>
  <li><a href="#early-stopping" id="toc-early-stopping" class="nav-link" data-scroll-target="#early-stopping">ğŸ”¹ Early Stopping</a></li>
  </ul></li>
  <li><a href="#batch-normalization-bn" id="toc-batch-normalization-bn" class="nav-link" data-scroll-target="#batch-normalization-bn">5.8 Batch Normalization (BN)</a>
  <ul class="collapse">
  <li><a href="#ä¸ºä»€ä¹ˆéœ€è¦-bn" id="toc-ä¸ºä»€ä¹ˆéœ€è¦-bn" class="nav-link" data-scroll-target="#ä¸ºä»€ä¹ˆéœ€è¦-bn">ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦ BNï¼Ÿ</a></li>
  <li><a href="#batch-normalization-åŸç†" id="toc-batch-normalization-åŸç†" class="nav-link" data-scroll-target="#batch-normalization-åŸç†">ğŸ’¡ Batch Normalization åŸç†</a></li>
  <li><a href="#bn-åœ¨å“ªé‡Œæ”¾" id="toc-bn-åœ¨å“ªé‡Œæ”¾" class="nav-link" data-scroll-target="#bn-åœ¨å“ªé‡Œæ”¾">ğŸ“ BN åœ¨å“ªé‡Œæ”¾ï¼Ÿ</a></li>
  <li><a href="#pytorch-å®ç°" id="toc-pytorch-å®ç°" class="nav-link" data-scroll-target="#pytorch-å®ç°">ğŸ’» PyTorch å®ç°</a></li>
  <li><a href="#batch-normalization-çš„ä¼˜ç‚¹" id="toc-batch-normalization-çš„ä¼˜ç‚¹" class="nav-link" data-scroll-target="#batch-normalization-çš„ä¼˜ç‚¹">âœ… Batch Normalization çš„ä¼˜ç‚¹</a></li>
  <li><a href="#bn-çš„ç¼ºç‚¹å’Œé™åˆ¶" id="toc-bn-çš„ç¼ºç‚¹å’Œé™åˆ¶" class="nav-link" data-scroll-target="#bn-çš„ç¼ºç‚¹å’Œé™åˆ¶">âš ï¸ BN çš„ç¼ºç‚¹å’Œé™åˆ¶</a></li>
  </ul></li>
  <li><a href="#å®æˆ˜å®Œæ•´è®­ç»ƒæµç¨‹" id="toc-å®æˆ˜å®Œæ•´è®­ç»ƒæµç¨‹" class="nav-link" data-scroll-target="#å®æˆ˜å®Œæ•´è®­ç»ƒæµç¨‹">5.9 å®æˆ˜ï¼šå®Œæ•´è®­ç»ƒæµç¨‹</a>
  <ul class="collapse">
  <li><a href="#pytorch-å®Œæ•´ç¤ºä¾‹" id="toc-pytorch-å®Œæ•´ç¤ºä¾‹" class="nav-link" data-scroll-target="#pytorch-å®Œæ•´ç¤ºä¾‹">ğŸ’» PyTorch å®Œæ•´ç¤ºä¾‹</a></li>
  </ul></li>
  <li><a href="#æœ¬ç« ä½œä¸š" id="toc-æœ¬ç« ä½œä¸š" class="nav-link" data-scroll-target="#æœ¬ç« ä½œä¸š">ğŸ“ æœ¬ç« ä½œä¸š</a>
  <ul class="collapse">
  <li><a href="#ä½œä¸š-1ä¼˜åŒ–å™¨å¯¹æ¯”" id="toc-ä½œä¸š-1ä¼˜åŒ–å™¨å¯¹æ¯”" class="nav-link" data-scroll-target="#ä½œä¸š-1ä¼˜åŒ–å™¨å¯¹æ¯”">ä½œä¸š 1ï¼šä¼˜åŒ–å™¨å¯¹æ¯”</a></li>
  <li><a href="#ä½œä¸š-2å­¦ä¹ ç‡è°ƒåº¦å®éªŒ" id="toc-ä½œä¸š-2å­¦ä¹ ç‡è°ƒåº¦å®éªŒ" class="nav-link" data-scroll-target="#ä½œä¸š-2å­¦ä¹ ç‡è°ƒåº¦å®éªŒ">ä½œä¸š 2ï¼šå­¦ä¹ ç‡è°ƒåº¦å®éªŒ</a></li>
  <li><a href="#ä½œä¸š-3æ­£åˆ™åŒ–æŠ€æœ¯å¯¹æ¯”" id="toc-ä½œä¸š-3æ­£åˆ™åŒ–æŠ€æœ¯å¯¹æ¯”" class="nav-link" data-scroll-target="#ä½œä¸š-3æ­£åˆ™åŒ–æŠ€æœ¯å¯¹æ¯”">ä½œä¸š 3ï¼šæ­£åˆ™åŒ–æŠ€æœ¯å¯¹æ¯”</a></li>
  <li><a href="#ä½œä¸š-4å®Œæ•´é¡¹ç›®" id="toc-ä½œä¸š-4å®Œæ•´é¡¹ç›®" class="nav-link" data-scroll-target="#ä½œä¸š-4å®Œæ•´é¡¹ç›®">ä½œä¸š 4ï¼šå®Œæ•´é¡¹ç›®</a></li>
  </ul></li>
  <li><a href="#æœ¬ç« å…³é”®æ¦‚å¿µ" id="toc-æœ¬ç« å…³é”®æ¦‚å¿µ" class="nav-link" data-scroll-target="#æœ¬ç« å…³é”®æ¦‚å¿µ">ğŸ”‘ æœ¬ç« å…³é”®æ¦‚å¿µ</a></li>
  <li><a href="#ä¸‹ä¸€ç« é¢„å‘Š" id="toc-ä¸‹ä¸€ç« é¢„å‘Š" class="nav-link" data-scroll-target="#ä¸‹ä¸€ç« é¢„å‘Š">ğŸ¯ ä¸‹ä¸€ç« é¢„å‘Š</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter5.html">ç¬¬äºŒéƒ¨åˆ†ï¼šè¿›é˜¶ç¯‡</a></li><li class="breadcrumb-item"><a href="./Chapter5.html"><span class="chapter-title">ç¬¬äº”ç« ï¼šä¼˜åŒ–ç®—æ³•ä¸è®­ç»ƒæŠ€å·§ (Optimization &amp; Training Tricks)</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">ç¬¬äº”ç« ï¼šä¼˜åŒ–ç®—æ³•ä¸è®­ç»ƒæŠ€å·§ (Optimization &amp; Training Tricks)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="ç« èŠ‚ç›®æ ‡" class="level2">
<h2 class="anchored" data-anchor-id="ç« èŠ‚ç›®æ ‡">ğŸ“Œ ç« èŠ‚ç›®æ ‡</h2>
<ul>
<li>ç†è§£ä¸åŒæ¢¯åº¦ä¸‹é™å˜ç§çš„åŸç†</li>
<li>æŒæ¡ç°ä»£ä¼˜åŒ–ç®—æ³•ï¼ˆMomentumã€Adamç­‰ï¼‰</li>
<li>å­¦ä¹ æ­£åˆ™åŒ–æŠ€æœ¯é˜²æ­¢è¿‡æ‹Ÿåˆ</li>
<li>äº†è§£æ‰¹å½’ä¸€åŒ–å’Œå­¦ä¹ ç‡è°ƒåº¦</li>
<li>æŒæ¡æ·±åº¦å­¦ä¹ è®­ç»ƒçš„å®ç”¨æŠ€å·§</li>
</ul>
<hr>
</section>
<section id="æ¢¯åº¦ä¸‹é™çš„å˜ç§" class="level2">
<h2 class="anchored" data-anchor-id="æ¢¯åº¦ä¸‹é™çš„å˜ç§">5.1 æ¢¯åº¦ä¸‹é™çš„å˜ç§</h2>
<section id="ä¸‰ç§æ¢¯åº¦ä¸‹é™" class="level3">
<h3 class="anchored" data-anchor-id="ä¸‰ç§æ¢¯åº¦ä¸‹é™">ğŸ”„ ä¸‰ç§æ¢¯åº¦ä¸‹é™</h3>
<section id="batch-gradient-descent-æ‰¹é‡æ¢¯åº¦ä¸‹é™" class="level4">
<h4 class="anchored" data-anchor-id="batch-gradient-descent-æ‰¹é‡æ¢¯åº¦ä¸‹é™"><strong>1. Batch Gradient Descent (æ‰¹é‡æ¢¯åº¦ä¸‹é™)</strong></h4>
<p><strong>æ¯æ¬¡ä½¿ç”¨å…¨éƒ¨è®­ç»ƒæ•°æ®</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(epochs):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ä½¿ç”¨æ‰€æœ‰æ•°æ®è®¡ç®—æ¢¯åº¦</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    gradients <span class="op">=</span> compute_gradients(X_train, y_train, parameters)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    parameters <span class="op">=</span> update_parameters(parameters, gradients, lr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>ä¼˜ç‚¹</strong>ï¼š - âœ… æ”¶æ•›ç¨³å®š - âœ… å¯ä»¥åˆ©ç”¨çŸ©é˜µè¿ç®—åŠ é€Ÿ</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š - âŒ æ•°æ®é‡å¤§æ—¶è®¡ç®—æ…¢ - âŒ å†…å­˜å ç”¨å¤§ - âŒ å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜</p>
<hr>
</section>
<section id="stochastic-gradient-descent-éšæœºæ¢¯åº¦ä¸‹é™sgd" class="level4">
<h4 class="anchored" data-anchor-id="stochastic-gradient-descent-éšæœºæ¢¯åº¦ä¸‹é™sgd"><strong>2. Stochastic Gradient Descent (éšæœºæ¢¯åº¦ä¸‹é™ï¼ŒSGD)</strong></h4>
<p><strong>æ¯æ¬¡ä½¿ç”¨ä¸€ä¸ªæ ·æœ¬</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(epochs):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># éšæœºæ‰“ä¹±æ•°æ®</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    indices <span class="op">=</span> np.random.permutation(<span class="bu">len</span>(X_train))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> indices:</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># æ¯æ¬¡ç”¨ä¸€ä¸ªæ ·æœ¬</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        gradients <span class="op">=</span> compute_gradients(X_train[i:i<span class="op">+</span><span class="dv">1</span>], y_train[i:i<span class="op">+</span><span class="dv">1</span>], parameters)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        parameters <span class="op">=</span> update_parameters(parameters, gradients, lr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>ä¼˜ç‚¹</strong>ï¼š - âœ… æ›´æ–°é¢‘ç¹ï¼Œæ”¶æ•›å¿« - âœ… å¯ä»¥é€ƒç¦»å±€éƒ¨æœ€ä¼˜ - âœ… å¯ä»¥åœ¨çº¿å­¦ä¹ </p>
<p><strong>ç¼ºç‚¹</strong>ï¼š - âŒ æ³¢åŠ¨å¤§ï¼Œä¸ç¨³å®š - âŒ éš¾ä»¥å¹¶è¡ŒåŒ– - âŒ å¯èƒ½ä¸æ”¶æ•›</p>
<p><strong>Loss æ›²çº¿å¯¹æ¯”</strong>ï¼š</p>
<pre><code>Batch GD:        SGD:
Loss             Loss
 â†“                â†“
 |\                |  *
 | \               | * *
 |  \              |*   *
 |   \___          | *   *
 |_______â†’        |___*___â†’
   Epoch            Epoch
 (å¹³æ»‘ä¸‹é™)        (éœ‡è¡ä¸‹é™)</code></pre>
<hr>
</section>
<section id="mini-batch-gradient-descent-å°æ‰¹é‡æ¢¯åº¦ä¸‹é™" class="level4">
<h4 class="anchored" data-anchor-id="mini-batch-gradient-descent-å°æ‰¹é‡æ¢¯åº¦ä¸‹é™"><strong>3. Mini-batch Gradient Descent (å°æ‰¹é‡æ¢¯åº¦ä¸‹é™)</strong> â­</h4>
<p><strong>æ¯æ¬¡ä½¿ç”¨ä¸€å°æ‰¹æ•°æ®ï¼ˆé€šå¸¸ 32-256ï¼‰</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">64</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(epochs):</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># éšæœºæ‰“ä¹±</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    indices <span class="op">=</span> np.random.permutation(<span class="bu">len</span>(X_train))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># åˆ†æ‰¹å¤„ç†</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(X_train), batch_size):</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        batch_indices <span class="op">=</span> indices[i:i<span class="op">+</span>batch_size]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        X_batch <span class="op">=</span> X_train[batch_indices]</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        y_batch <span class="op">=</span> y_train[batch_indices]</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># è®¡ç®—æ¢¯åº¦å’Œæ›´æ–°</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        gradients <span class="op">=</span> compute_gradients(X_batch, y_batch, parameters)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        parameters <span class="op">=</span> update_parameters(parameters, gradients, lr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>ä¼˜ç‚¹</strong>ï¼š - âœ… å¹³è¡¡äº†é€Ÿåº¦å’Œç¨³å®šæ€§ - âœ… å¯ä»¥åˆ©ç”¨ GPU å¹¶è¡Œ - âœ… æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š - éœ€è¦è°ƒæ•´ batch_size</p>
<p><strong>Batch Size é€‰æ‹©</strong>ï¼š</p>
<pre><code>å° batch (16-32):
  + æ³›åŒ–èƒ½åŠ›å¼º
  + é€‚åˆå°æ•°æ®é›†
  - è®­ç»ƒä¸ç¨³å®š
  - é€Ÿåº¦æ…¢

å¤§ batch (256-512):
  + è®­ç»ƒç¨³å®š
  + å……åˆ†åˆ©ç”¨ GPU
  + é€Ÿåº¦å¿«
  - å¯èƒ½è¿‡æ‹Ÿåˆ
  - æ³›åŒ–èƒ½åŠ›è¾ƒå¼±

å¸¸ç”¨: 32, 64, 128</code></pre>
<hr>
</section>
</section>
<section id="å®ç°-mini-batch" class="level3">
<h3 class="anchored" data-anchor-id="å®ç°-mini-batch">ğŸ’» å®ç° Mini-batch</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_mini_batches(X, y, batch_size):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">    åˆ›å»º mini-batches</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">    è¿”å›ï¼š</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">        mini_batches: åˆ—è¡¨ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ (X_batch, y_batch)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> X.shape[<span class="dv">0</span>]</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    mini_batches <span class="op">=</span> []</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># éšæœºæ‰“ä¹±</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    permutation <span class="op">=</span> np.random.permutation(m)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    shuffled_X <span class="op">=</span> X[permutation]</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    shuffled_y <span class="op">=</span> y[permutation]</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># åˆ†æ‰¹</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    num_complete_batches <span class="op">=</span> m <span class="op">//</span> batch_size</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(num_complete_batches):</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        X_batch <span class="op">=</span> shuffled_X[k<span class="op">*</span>batch_size:(k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>batch_size]</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>        y_batch <span class="op">=</span> shuffled_y[k<span class="op">*</span>batch_size:(k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>batch_size]</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>        mini_batches.append((X_batch, y_batch))</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># å¤„ç†å‰©ä½™çš„æ•°æ®</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> m <span class="op">%</span> batch_size <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        X_batch <span class="op">=</span> shuffled_X[num_complete_batches<span class="op">*</span>batch_size:]</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        y_batch <span class="op">=</span> shuffled_y[num_complete_batches<span class="op">*</span>batch_size:]</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        mini_batches.append((X_batch, y_batch))</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mini_batches</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co"># ä½¿ç”¨</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_with_mini_batch(X, y, parameters, epochs, batch_size, learning_rate):</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""ä½¿ç”¨ mini-batch è®­ç»ƒ"""</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    losses <span class="op">=</span> []</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(epochs):</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>        epoch_loss <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>        mini_batches <span class="op">=</span> create_mini_batches(X, y, batch_size)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> X_batch, y_batch <span class="kw">in</span> mini_batches:</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>            <span class="co"># å‰å‘ä¼ æ’­</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>            y_pred, cache <span class="op">=</span> forward_propagation(X_batch, parameters)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>            <span class="co"># è®¡ç®—æŸå¤±</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> compute_loss(y_pred, y_batch)</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>            epoch_loss <span class="op">+=</span> loss</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>            <span class="co"># åå‘ä¼ æ’­</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>            gradients <span class="op">=</span> backward_propagation(X_batch, y_batch, parameters, cache)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>            <span class="co"># æ›´æ–°å‚æ•°</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>            parameters <span class="op">=</span> update_parameters(parameters, gradients, learning_rate)</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># å¹³å‡æŸå¤±</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>        avg_loss <span class="op">=</span> epoch_loss <span class="op">/</span> <span class="bu">len</span>(mini_batches)</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>        losses.append(avg_loss)</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">100</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Epoch </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">: Loss = </span><span class="sc">{</span>avg_loss<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parameters, losses</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="åŠ¨é‡æ³•-momentum" class="level2">
<h2 class="anchored" data-anchor-id="åŠ¨é‡æ³•-momentum">5.2 åŠ¨é‡æ³• (Momentum)</h2>
<section id="é—®é¢˜æ¢¯åº¦ä¸‹é™çš„éœ‡è¡" class="level3">
<h3 class="anchored" data-anchor-id="é—®é¢˜æ¢¯åº¦ä¸‹é™çš„éœ‡è¡">ğŸ¯ é—®é¢˜ï¼šæ¢¯åº¦ä¸‹é™çš„éœ‡è¡</h3>
<pre><code>Loss
 â†‘
 |     *
 |    * *
 |   *   *     â† å‚ç›´æ–¹å‘éœ‡è¡
 |  *     *
 | *       *
 |__________â†’
   å‚æ•°ç©ºé—´

ç†æƒ³ï¼šæ¨ªå‘å¿«é€Ÿå‰è¿›ï¼Œçºµå‘å‡å°‘éœ‡è¡</code></pre>
</section>
<section id="åŠ¨é‡æ³•åŸç†" class="level3">
<h3 class="anchored" data-anchor-id="åŠ¨é‡æ³•åŸç†">ğŸ’¡ åŠ¨é‡æ³•åŸç†</h3>
<p><strong>ç‰©ç†ç±»æ¯”</strong>ï¼šæ»šä¸‹å±±çš„å°çƒ</p>
<pre><code>å°çƒä¸ä¼šç«‹åˆ»æ”¹å˜æ–¹å‘
è€Œæ˜¯ç´¯ç§¯åŠ¨é‡ï¼Œå¹³æ»‘åœ°æ»šåŠ¨</code></pre>
<p><strong>æ•°å­¦å…¬å¼</strong>ï¼š</p>
<pre><code>v_t = Î²Â·v_{t-1} + (1-Î²)Â·âˆ‡L_t

Î¸_t = Î¸_{t-1} - Î±Â·v_t

å…¶ä¸­ï¼š
  v_t: é€Ÿåº¦ï¼ˆåŠ¨é‡ï¼‰
  Î²: åŠ¨é‡ç³»æ•°ï¼ˆé€šå¸¸ 0.9ï¼‰
  âˆ‡L_t: å½“å‰æ¢¯åº¦
  Î±: å­¦ä¹ ç‡</code></pre>
<p><strong>æŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡</strong>ï¼š</p>
<pre><code>v_t = Î²Â·v_{t-1} + (1-Î²)Â·g_t
    = (1-Î²)Â·g_t + Î²Â·(1-Î²)Â·g_{t-1} + Î²Â²Â·(1-Î²)Â·g_{t-2} + ...

æƒé‡ï¼š
  g_t:   (1-Î²) = 0.1
  g_{t-1}: Î²(1-Î²) = 0.09
  g_{t-2}: Î²Â²(1-Î²) = 0.081
  ...

è¶Šè¿‘çš„æ¢¯åº¦æƒé‡è¶Šå¤§</code></pre>
</section>
<section id="æ•ˆæœå¯¹æ¯”" class="level3">
<h3 class="anchored" data-anchor-id="æ•ˆæœå¯¹æ¯”">ğŸ“Š æ•ˆæœå¯¹æ¯”</h3>
<pre><code>ä¸ä½¿ç”¨åŠ¨é‡:        ä½¿ç”¨åŠ¨é‡:
    *                 â”€â”€â†’
   * *               â”€â”€â†’
  *   *             â”€â”€â†’
 *     *           â”€â”€â†’
*éœ‡è¡  *          å¹³æ»‘</code></pre>
</section>
<section id="å®ç°" class="level3">
<h3 class="anchored" data-anchor-id="å®ç°">ğŸ’» å®ç°</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_momentum(parameters):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">    åˆå§‹åŒ–åŠ¨é‡</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">    è¿”å›ï¼š</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">        v: å­—å…¸ï¼Œä¸ parameters ç»“æ„ç›¸åŒï¼Œåˆå§‹åŒ–ä¸º 0</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> {}</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    L <span class="op">=</span> <span class="bu">len</span>(parameters) <span class="op">//</span> <span class="dv">2</span>  <span class="co"># W å’Œ b çš„å¯¹æ•°</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, L <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        v[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> np.zeros_like(parameters[<span class="ss">f'W</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        v[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> np.zeros_like(parameters[<span class="ss">f'b</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> v</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update_parameters_with_momentum(parameters, gradients, v, learning_rate, beta<span class="op">=</span><span class="fl">0.9</span>):</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">    ä½¿ç”¨åŠ¨é‡æ›´æ–°å‚æ•°</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">    å‚æ•°ï¼š</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co">        parameters: å½“å‰å‚æ•°</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co">        gradients: æ¢¯åº¦</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">        v: åŠ¨é‡</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co">        learning_rate: å­¦ä¹ ç‡</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="co">        beta: åŠ¨é‡ç³»æ•°</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    L <span class="op">=</span> <span class="bu">len</span>(parameters) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, L <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># æ›´æ–°åŠ¨é‡</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        v[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> beta <span class="op">*</span> v[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> beta) <span class="op">*</span> gradients[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>        v[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> beta <span class="op">*</span> v[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> beta) <span class="op">*</span> gradients[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># æ›´æ–°å‚æ•°</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        parameters[<span class="ss">f'W</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">-=</span> learning_rate <span class="op">*</span> v[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>        parameters[<span class="ss">f'b</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">-=</span> learning_rate <span class="op">*</span> v[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parameters, v</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="co"># ä½¿ç”¨ç¤ºä¾‹</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> initialize_momentum(parameters)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(epochs):</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> X_batch, y_batch <span class="kw">in</span> mini_batches:</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>        y_pred, cache <span class="op">=</span> forward_propagation(X_batch, parameters)</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>        gradients <span class="op">=</span> backward_propagation(X_batch, y_batch, parameters, cache)</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ä½¿ç”¨åŠ¨é‡æ›´æ–°</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>        parameters, v <span class="op">=</span> update_parameters_with_momentum(</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>            parameters, gradients, v, learning_rate, beta<span class="op">=</span><span class="fl">0.9</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>        )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="rmsprop-root-mean-square-propagation" class="level2">
<h2 class="anchored" data-anchor-id="rmsprop-root-mean-square-propagation">5.3 RMSprop (Root Mean Square Propagation)</h2>
<section id="é—®é¢˜ä¸åŒå‚æ•°éœ€è¦ä¸åŒå­¦ä¹ ç‡" class="level3">
<h3 class="anchored" data-anchor-id="é—®é¢˜ä¸åŒå‚æ•°éœ€è¦ä¸åŒå­¦ä¹ ç‡">ğŸ¯ é—®é¢˜ï¼šä¸åŒå‚æ•°éœ€è¦ä¸åŒå­¦ä¹ ç‡</h3>
<pre><code>å‚æ•° wâ‚: æ¢¯åº¦èŒƒå›´ [-100, 100]  â† éœ€è¦å°å­¦ä¹ ç‡
å‚æ•° wâ‚‚: æ¢¯åº¦èŒƒå›´ [-0.01, 0.01] â† éœ€è¦å¤§å­¦ä¹ ç‡

å›ºå®šå­¦ä¹ ç‡æ— æ³•åŒæ—¶æ»¡è¶³</code></pre>
</section>
<section id="rmsprop-åŸç†" class="level3">
<h3 class="anchored" data-anchor-id="rmsprop-åŸç†">ğŸ’¡ RMSprop åŸç†</h3>
<p><strong>è‡ªé€‚åº”è°ƒæ•´æ¯ä¸ªå‚æ•°çš„å­¦ä¹ ç‡</strong></p>
<pre><code>s_t = Î²Â·s_{t-1} + (1-Î²)Â·(âˆ‡L_t)Â²

Î¸_t = Î¸_{t-1} - Î±Â·âˆ‡L_t / âˆš(s_t + Îµ)

å…¶ä¸­ï¼š
  s_t: æ¢¯åº¦å¹³æ–¹çš„æŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡
  Î²: è¡°å‡ç‡ï¼ˆé€šå¸¸ 0.999ï¼‰
  Îµ: é˜²æ­¢é™¤é›¶ï¼ˆé€šå¸¸ 10â»â¸ï¼‰</code></pre>
<p><strong>ç›´è§‰</strong>ï¼š - æ¢¯åº¦å¤§ â†’ s å¤§ â†’ æ­¥é•¿å°ï¼ˆé™¤ä»¥å¤§æ•°ï¼‰ - æ¢¯åº¦å° â†’ s å° â†’ æ­¥é•¿å¤§ï¼ˆé™¤ä»¥å°æ•°ï¼‰</p>
</section>
<section id="å®ç°-1" class="level3">
<h3 class="anchored" data-anchor-id="å®ç°-1">ğŸ’» å®ç°</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_rmsprop(parameters):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""åˆå§‹åŒ– RMSprop"""</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> {}</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    L <span class="op">=</span> <span class="bu">len</span>(parameters) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, L <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        s[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> np.zeros_like(parameters[<span class="ss">f'W</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        s[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> np.zeros_like(parameters[<span class="ss">f'b</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update_parameters_with_rmsprop(parameters, gradients, s, learning_rate,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                                   beta<span class="op">=</span><span class="fl">0.999</span>, epsilon<span class="op">=</span><span class="fl">1e-8</span>):</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""ä½¿ç”¨ RMSprop æ›´æ–°å‚æ•°"""</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    L <span class="op">=</span> <span class="bu">len</span>(parameters) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, L <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># æ›´æ–°å¹³æ–¹æ¢¯åº¦çš„ç§»åŠ¨å¹³å‡</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        s[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> beta <span class="op">*</span> s[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> beta) <span class="op">*</span> gradients[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        s[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> beta <span class="op">*</span> s[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> beta) <span class="op">*</span> gradients[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># æ›´æ–°å‚æ•°</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        parameters[<span class="ss">f'W</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">-=</span> learning_rate <span class="op">*</span> gradients[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">/</span> (np.sqrt(s[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]) <span class="op">+</span> epsilon)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        parameters[<span class="ss">f'b</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">-=</span> learning_rate <span class="op">*</span> gradients[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">/</span> (np.sqrt(s[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]) <span class="op">+</span> epsilon)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parameters, s</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="adam-adaptive-moment-estimation" class="level2">
<h2 class="anchored" data-anchor-id="adam-adaptive-moment-estimation">5.4 Adam (Adaptive Moment Estimation) â­</h2>
<section id="adam-momentum-rmsprop" class="level3">
<h3 class="anchored" data-anchor-id="adam-momentum-rmsprop">ğŸ¯ Adam = Momentum + RMSprop</h3>
<p><strong>ç»“åˆä¸¤è€…ä¼˜ç‚¹</strong>ï¼š - Momentumï¼šå¹³æ»‘æ¢¯åº¦æ–¹å‘ - RMSpropï¼šè‡ªé€‚åº”å­¦ä¹ ç‡</p>
</section>
<section id="ç®—æ³•" class="level3">
<h3 class="anchored" data-anchor-id="ç®—æ³•">ğŸ“ ç®—æ³•</h3>
<pre><code>åˆå§‹åŒ–ï¼š
  vâ‚€ = 0  (ä¸€é˜¶çŸ©ä¼°è®¡ï¼ŒåŠ¨é‡)
  sâ‚€ = 0  (äºŒé˜¶çŸ©ä¼°è®¡ï¼ŒRMSprop)

æ¯æ¬¡è¿­ä»£ï¼š
  1. è®¡ç®—æ¢¯åº¦ g_t = âˆ‡L_t

  2. æ›´æ–°åŠ¨é‡ï¼š
     v_t = Î²â‚Â·v_{t-1} + (1-Î²â‚)Â·g_t

  3. æ›´æ–°å¹³æ–¹æ¢¯åº¦ï¼š
     s_t = Î²â‚‚Â·s_{t-1} + (1-Î²â‚‚)Â·g_tÂ²

  4. åå·®ä¿®æ­£ï¼š
     vÌ‚_t = v_t / (1 - Î²â‚áµ—)
     Å_t = s_t / (1 - Î²â‚‚áµ—)

  5. æ›´æ–°å‚æ•°ï¼š
     Î¸_t = Î¸_{t-1} - Î±Â·vÌ‚_t / (âˆšÅ_t + Îµ)

é»˜è®¤è¶…å‚æ•°ï¼š
  Î± = 0.001
  Î²â‚ = 0.9
  Î²â‚‚ = 0.999
  Îµ = 10â»â¸</code></pre>
</section>
<section id="ä¸ºä»€ä¹ˆéœ€è¦åå·®ä¿®æ­£" class="level3">
<h3 class="anchored" data-anchor-id="ä¸ºä»€ä¹ˆéœ€è¦åå·®ä¿®æ­£">ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦åå·®ä¿®æ­£ï¼Ÿ</h3>
<pre><code>åˆå§‹æ—¶ vâ‚€ = 0, sâ‚€ = 0

ç¬¬ä¸€æ­¥ï¼š
  vâ‚ = 0.9Â·0 + 0.1Â·gâ‚ = 0.1Â·gâ‚

é—®é¢˜ï¼švâ‚ è¿œå°äºçœŸå®æœŸæœ›ï¼
  (å› ä¸ºåˆå§‹åŒ–ä¸º 0ï¼Œæœ‰åå·®)

ä¿®æ­£ï¼š
  vÌ‚â‚ = vâ‚ / (1 - 0.9Â¹) = 0.1Â·gâ‚ / 0.1 = gâ‚  âœ“

éšç€ t å¢å¤§ï¼š
  (1 - Î²â‚áµ—) â†’ 1
  ä¿®æ­£æ•ˆæœé€æ¸æ¶ˆå¤±</code></pre>
</section>
<section id="å®Œæ•´å®ç°" class="level3">
<h3 class="anchored" data-anchor-id="å®Œæ•´å®ç°">ğŸ’» å®Œæ•´å®ç°</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_adam(parameters):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">    åˆå§‹åŒ– Adam ä¼˜åŒ–å™¨</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">    è¿”å›ï¼š</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">        v: ä¸€é˜¶çŸ©ä¼°è®¡ï¼ˆåŠ¨é‡ï¼‰</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">        s: äºŒé˜¶çŸ©ä¼°è®¡ï¼ˆRMSpropï¼‰</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> {}</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> {}</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    L <span class="op">=</span> <span class="bu">len</span>(parameters) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, L <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        v[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> np.zeros_like(parameters[<span class="ss">f'W</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        v[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> np.zeros_like(parameters[<span class="ss">f'b</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        s[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> np.zeros_like(parameters[<span class="ss">f'W</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        s[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> np.zeros_like(parameters[<span class="ss">f'b</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> v, s</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update_parameters_with_adam(parameters, gradients, v, s, t,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>                                learning_rate<span class="op">=</span><span class="fl">0.001</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>                                beta1<span class="op">=</span><span class="fl">0.9</span>, beta2<span class="op">=</span><span class="fl">0.999</span>, epsilon<span class="op">=</span><span class="fl">1e-8</span>):</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co">    ä½¿ç”¨ Adam æ›´æ–°å‚æ•°</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co">    å‚æ•°ï¼š</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co">        t: å½“å‰è¿­ä»£æ¬¡æ•°ï¼ˆä» 1 å¼€å§‹ï¼‰</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    L <span class="op">=</span> <span class="bu">len</span>(parameters) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    v_corrected <span class="op">=</span> {}</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    s_corrected <span class="op">=</span> {}</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, L <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># æ›´æ–°åŠ¨é‡</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>        v[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> beta1 <span class="op">*</span> v[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> beta1) <span class="op">*</span> gradients[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>        v[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> beta1 <span class="op">*</span> v[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> beta1) <span class="op">*</span> gradients[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># æ›´æ–°å¹³æ–¹æ¢¯åº¦</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>        s[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> beta2 <span class="op">*</span> s[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> beta2) <span class="op">*</span> (gradients[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>        s[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> beta2 <span class="op">*</span> s[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> beta2) <span class="op">*</span> (gradients[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># åå·®ä¿®æ­£</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>        v_corrected[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> v[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> beta1<span class="op">**</span>t)</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>        v_corrected[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> v[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> beta1<span class="op">**</span>t)</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>        s_corrected[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> s[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> beta2<span class="op">**</span>t)</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>        s_corrected[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> s[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> beta2<span class="op">**</span>t)</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># æ›´æ–°å‚æ•°</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>        parameters[<span class="ss">f'W</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">-=</span> learning_rate <span class="op">*</span> v_corrected[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">/</span> (np.sqrt(s_corrected[<span class="ss">f'dW</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]) <span class="op">+</span> epsilon)</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>        parameters[<span class="ss">f'b</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">-=</span> learning_rate <span class="op">*</span> v_corrected[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">/</span> (np.sqrt(s_corrected[<span class="ss">f'db</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>]) <span class="op">+</span> epsilon)</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parameters, v, s</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a><span class="co"># ä½¿ç”¨ç¤ºä¾‹</span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_with_adam(X_train, y_train, layer_dims, epochs<span class="op">=</span><span class="dv">1000</span>, batch_size<span class="op">=</span><span class="dv">64</span>):</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""ä½¿ç”¨ Adam è®­ç»ƒç½‘ç»œ"""</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># åˆå§‹åŒ–å‚æ•°</span></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>    parameters <span class="op">=</span> initialize_parameters(layer_dims)</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>    v, s <span class="op">=</span> initialize_adam(parameters)</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>    losses <span class="op">=</span> []</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="dv">0</span>  <span class="co"># å…¨å±€è¿­ä»£è®¡æ•°å™¨</span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(epochs):</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>        mini_batches <span class="op">=</span> create_mini_batches(X_train, y_train, batch_size)</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>        epoch_loss <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> X_batch, y_batch <span class="kw">in</span> mini_batches:</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>            t <span class="op">+=</span> <span class="dv">1</span>  <span class="co"># æ¯ä¸ª mini-batch å¢åŠ è®¡æ•°</span></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>            <span class="co"># å‰å‘ä¼ æ’­</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>            AL, caches <span class="op">=</span> forward_propagation_deep(X_batch, parameters)</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>            <span class="co"># è®¡ç®—æŸå¤±</span></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> compute_loss(AL, y_batch)</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>            epoch_loss <span class="op">+=</span> loss</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>            <span class="co"># åå‘ä¼ æ’­</span></span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>            gradients <span class="op">=</span> backward_propagation_deep(AL, y_batch, caches)</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adam æ›´æ–°</span></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>            parameters, v, s <span class="op">=</span> update_parameters_with_adam(</span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>                parameters, gradients, v, s, t</span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>        avg_loss <span class="op">=</span> epoch_loss <span class="op">/</span> <span class="bu">len</span>(mini_batches)</span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>        losses.append(avg_loss)</span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">100</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Epoch </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">: Loss = </span><span class="sc">{</span>avg_loss<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parameters, losses</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="ä¼˜åŒ–å™¨å¯¹æ¯”" class="level2">
<h2 class="anchored" data-anchor-id="ä¼˜åŒ–å™¨å¯¹æ¯”">5.5 ä¼˜åŒ–å™¨å¯¹æ¯”</h2>
<section id="å¯è§†åŒ–å¯¹æ¯”" class="level3">
<h3 class="anchored" data-anchor-id="å¯è§†åŒ–å¯¹æ¯”">ğŸ“Š å¯è§†åŒ–å¯¹æ¯”</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.animation <span class="im">import</span> FuncAnimation</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># å®šä¹‰ä¸€ä¸ªéå‡¸å‡½æ•°ï¼ˆç±»ä¼¼ Rosenbrockï¼‰</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x, y):</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">1</span> <span class="op">-</span> x)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">100</span> <span class="op">*</span> (y <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> grad_f(x, y):</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""è®¡ç®—æ¢¯åº¦"""</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    dx <span class="op">=</span> <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x) <span class="op">-</span> <span class="dv">400</span> <span class="op">*</span> x <span class="op">*</span> (y <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    dy <span class="op">=</span> <span class="dv">200</span> <span class="op">*</span> (y <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([dx, dy])</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># åˆ›å»ºç­‰é«˜çº¿å›¾</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">100</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> f(X, Y)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># æµ‹è¯•ä¸åŒä¼˜åŒ–å™¨</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sgd(pos, grad, lr<span class="op">=</span><span class="fl">0.001</span>):</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pos <span class="op">-</span> lr <span class="op">*</span> grad</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> momentum(pos, grad, v, beta<span class="op">=</span><span class="fl">0.9</span>, lr<span class="op">=</span><span class="fl">0.001</span>):</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> beta <span class="op">*</span> v <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> beta) <span class="op">*</span> grad</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pos <span class="op">-</span> lr <span class="op">*</span> v, v</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rmsprop(pos, grad, s, beta<span class="op">=</span><span class="fl">0.999</span>, lr<span class="op">=</span><span class="fl">0.001</span>, eps<span class="op">=</span><span class="fl">1e-8</span>):</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> beta <span class="op">*</span> s <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> beta) <span class="op">*</span> grad<span class="op">**</span><span class="dv">2</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pos <span class="op">-</span> lr <span class="op">*</span> grad <span class="op">/</span> (np.sqrt(s) <span class="op">+</span> eps), s</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> adam(pos, grad, v, s, t, beta1<span class="op">=</span><span class="fl">0.9</span>, beta2<span class="op">=</span><span class="fl">0.999</span>, lr<span class="op">=</span><span class="fl">0.001</span>, eps<span class="op">=</span><span class="fl">1e-8</span>):</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> beta1 <span class="op">*</span> v <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> beta1) <span class="op">*</span> grad</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> beta2 <span class="op">*</span> s <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> beta2) <span class="op">*</span> grad<span class="op">**</span><span class="dv">2</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    v_hat <span class="op">=</span> v <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> beta1<span class="op">**</span>t)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    s_hat <span class="op">=</span> s <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> beta2<span class="op">**</span>t)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pos <span class="op">-</span> lr <span class="op">*</span> v_hat <span class="op">/</span> (np.sqrt(s_hat) <span class="op">+</span> eps), v, s</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="co"># è¿è¡Œä¼˜åŒ–</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_optimizer(optimizer_name, steps<span class="op">=</span><span class="dv">200</span>):</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>    pos <span class="op">=</span> np.array([<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">2.5</span>])</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    trajectory <span class="op">=</span> [pos.copy()]</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> optimizer_name <span class="op">==</span> <span class="st">'SGD'</span>:</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(steps):</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>            grad <span class="op">=</span> grad_f(pos[<span class="dv">0</span>], pos[<span class="dv">1</span>])</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>            pos <span class="op">=</span> sgd(pos, grad)</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>            trajectory.append(pos.copy())</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> optimizer_name <span class="op">==</span> <span class="st">'Momentum'</span>:</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>        v <span class="op">=</span> np.zeros(<span class="dv">2</span>)</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(steps):</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>            grad <span class="op">=</span> grad_f(pos[<span class="dv">0</span>], pos[<span class="dv">1</span>])</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>            pos, v <span class="op">=</span> momentum(pos, grad, v)</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>            trajectory.append(pos.copy())</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> optimizer_name <span class="op">==</span> <span class="st">'RMSprop'</span>:</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> np.zeros(<span class="dv">2</span>)</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(steps):</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>            grad <span class="op">=</span> grad_f(pos[<span class="dv">0</span>], pos[<span class="dv">1</span>])</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>            pos, s <span class="op">=</span> rmsprop(pos, grad, s)</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>            trajectory.append(pos.copy())</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> optimizer_name <span class="op">==</span> <span class="st">'Adam'</span>:</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>        v <span class="op">=</span> np.zeros(<span class="dv">2</span>)</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> np.zeros(<span class="dv">2</span>)</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, steps <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>            grad <span class="op">=</span> grad_f(pos[<span class="dv">0</span>], pos[<span class="dv">1</span>])</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>            pos, v, s <span class="op">=</span> adam(pos, grad, v, s, t)</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>            trajectory.append(pos.copy())</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(trajectory)</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a><span class="co"># ç»˜åˆ¶å¯¹æ¯”å›¾</span></span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">12</span>))</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>optimizers <span class="op">=</span> [<span class="st">'SGD'</span>, <span class="st">'Momentum'</span>, <span class="st">'RMSprop'</span>, <span class="st">'Adam'</span>]</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, opt_name <span class="kw">in</span> <span class="bu">zip</span>(axes.flat, optimizers):</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>    ax.contour(X, Y, Z, levels<span class="op">=</span>np.logspace(<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">20</span>), cmap<span class="op">=</span><span class="st">'viridis'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>    trajectory <span class="op">=</span> run_optimizer(opt_name, steps<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>    ax.plot(trajectory[:, <span class="dv">0</span>], trajectory[:, <span class="dv">1</span>], <span class="st">'r-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>    ax.plot(trajectory[<span class="dv">0</span>, <span class="dv">0</span>], trajectory[<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'go'</span>, markersize<span class="op">=</span><span class="dv">10</span>, label<span class="op">=</span><span class="st">'èµ·ç‚¹'</span>)</span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>    ax.plot(<span class="dv">1</span>, <span class="dv">1</span>, <span class="st">'r*'</span>, markersize<span class="op">=</span><span class="dv">15</span>, label<span class="op">=</span><span class="st">'æœ€ä¼˜ç‚¹'</span>)</span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'</span><span class="sc">{</span>opt_name<span class="sc">}</span><span class="ss"> Optimizer'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>    ax.legend()</span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="æ€§èƒ½å¯¹æ¯”è¡¨" class="level3">
<h3 class="anchored" data-anchor-id="æ€§èƒ½å¯¹æ¯”è¡¨">ğŸ“ˆ æ€§èƒ½å¯¹æ¯”è¡¨</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ä¼˜åŒ–å™¨</th>
<th>æ”¶æ•›é€Ÿåº¦</th>
<th>ç¨³å®šæ€§</th>
<th>å†…å­˜å¼€é”€</th>
<th>è¶…å‚æ•°æ•æ„Ÿåº¦</th>
<th>æ¨èåº¦</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SGD</td>
<td>â˜…â˜…â˜†â˜†â˜†</td>
<td>â˜…â˜…â˜†â˜†â˜†</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
<td>â˜…â˜…â˜†â˜†â˜†</td>
</tr>
<tr class="even">
<td>SGD+Momentum</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
<td>â˜…â˜…â˜…â˜†â˜†</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
</tr>
<tr class="odd">
<td>RMSprop</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
<td>â˜…â˜…â˜…â˜†â˜†</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
</tr>
<tr class="even">
<td>Adam</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
<td>â˜…â˜…â˜…â˜†â˜†</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
</tr>
<tr class="odd">
<td>AdaGrad</td>
<td>â˜…â˜…â˜…â˜†â˜†</td>
<td>â˜…â˜…â˜…â˜†â˜†</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
<td>â˜…â˜…â˜…â˜…â˜†</td>
<td>â˜…â˜…â˜†â˜†â˜†</td>
</tr>
<tr class="even">
<td>AdamW</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
<td>â˜…â˜…â˜…â˜†â˜†</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
</tr>
</tbody>
</table>
</section>
<section id="é€‰æ‹©æŒ‡å—" class="level3">
<h3 class="anchored" data-anchor-id="é€‰æ‹©æŒ‡å—">ğŸ’¡ é€‰æ‹©æŒ‡å—</h3>
<pre><code>é»˜è®¤é€‰æ‹©ï¼šAdam â­
  - å‡ ä¹é€‚ç”¨äºæ‰€æœ‰åœºæ™¯
  - ä¸éœ€è¦å¤ªå¤šè°ƒå‚
  - æ”¶æ•›å¿«ä¸”ç¨³å®š

éœ€è¦æœ€ä½³æ€§èƒ½ï¼šSGD + Momentum
  - è®­ç»ƒæ—¶é—´è¶³å¤Ÿæ—¶
  - é…åˆ Learning Rate Schedule
  - é€šå¸¸æ³›åŒ–èƒ½åŠ›æ›´å¥½

è®¡ç®—æœºè§†è§‰ï¼šSGD + Momentum
  - ResNet, VGG ç­‰ç»å…¸æ¨¡å‹
  - éœ€è¦ä»”ç»†è°ƒæ•´å­¦ä¹ ç‡

NLP / Transformerï¼šAdam / AdamW
  - BERT, GPT æ ‡é…
  - AdamW åŠ å…¥æƒé‡è¡°å‡

å†…å­˜å—é™ï¼šSGD
  - ä¸éœ€è¦é¢å¤–å­˜å‚¨åŠ¨é‡</code></pre>
<hr>
</section>
</section>
<section id="å­¦ä¹ ç‡è°ƒåº¦-learning-rate-scheduling" class="level2">
<h2 class="anchored" data-anchor-id="å­¦ä¹ ç‡è°ƒåº¦-learning-rate-scheduling">5.6 å­¦ä¹ ç‡è°ƒåº¦ (Learning Rate Scheduling)</h2>
<section id="ä¸ºä»€ä¹ˆéœ€è¦è°ƒæ•´å­¦ä¹ ç‡" class="level3">
<h3 class="anchored" data-anchor-id="ä¸ºä»€ä¹ˆéœ€è¦è°ƒæ•´å­¦ä¹ ç‡">ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦è°ƒæ•´å­¦ä¹ ç‡ï¼Ÿ</h3>
<pre><code>è®­ç»ƒåˆæœŸï¼š
  - ç¦»æœ€ä¼˜ç‚¹è¿œ
  - å¯ä»¥ç”¨å¤§å­¦ä¹ ç‡å¿«é€Ÿæ¥è¿‘

è®­ç»ƒåæœŸï¼š
  - æ¥è¿‘æœ€ä¼˜ç‚¹
  - éœ€è¦å°å­¦ä¹ ç‡ç²¾ç»†è°ƒæ•´

å›ºå®šå­¦ä¹ ç‡ï¼š
  å¤ªå¤§ â†’ éœ‡è¡ï¼Œä¸æ”¶æ•›
  å¤ªå° â†’ è®­ç»ƒæ…¢</code></pre>
</section>
<section id="å¸¸è§è°ƒåº¦ç­–ç•¥" class="level3">
<h3 class="anchored" data-anchor-id="å¸¸è§è°ƒåº¦ç­–ç•¥">ğŸ“Š å¸¸è§è°ƒåº¦ç­–ç•¥</h3>
<section id="step-decay-é˜¶æ¢¯è¡°å‡" class="level4">
<h4 class="anchored" data-anchor-id="step-decay-é˜¶æ¢¯è¡°å‡"><strong>1. Step Decay (é˜¶æ¢¯è¡°å‡)</strong></h4>
<pre><code>æ¯éš”å›ºå®š epochï¼Œå­¦ä¹ ç‡ä¹˜ä»¥è¡°å‡å› å­

lr_t = lr_0 Â· Î³^âŒŠepoch/step_sizeâŒ‹

ä¾‹ï¼š
  lr_0 = 0.1
  Î³ = 0.1
  step_size = 30

  epoch 0-29:  lr = 0.1
  epoch 30-59: lr = 0.01
  epoch 60-89: lr = 0.001</code></pre>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> step_decay_schedule(epoch, lr, drop<span class="op">=</span><span class="fl">0.5</span>, epochs_drop<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""é˜¶æ¢¯è¡°å‡"""</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lr <span class="op">*</span> (drop <span class="op">**</span> (epoch <span class="op">//</span> epochs_drop))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="exponential-decay-æŒ‡æ•°è¡°å‡" class="level4">
<h4 class="anchored" data-anchor-id="exponential-decay-æŒ‡æ•°è¡°å‡"><strong>2. Exponential Decay (æŒ‡æ•°è¡°å‡)</strong></h4>
<pre><code>lr_t = lr_0 Â· e^(-Î»t)

æˆ–

lr_t = lr_0 Â· Î³^t</code></pre>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> exponential_decay(epoch, lr_0, decay_rate<span class="op">=</span><span class="fl">0.96</span>):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""æŒ‡æ•°è¡°å‡"""</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lr_0 <span class="op">*</span> np.exp(<span class="op">-</span>decay_rate <span class="op">*</span> epoch)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="cosine-annealing-ä½™å¼¦é€€ç«" class="level4">
<h4 class="anchored" data-anchor-id="cosine-annealing-ä½™å¼¦é€€ç«"><strong>3. Cosine Annealing (ä½™å¼¦é€€ç«)</strong></h4>
<pre><code>lr_t = lr_min + (lr_max - lr_min) Â· (1 + cos(Ï€t/T)) / 2

å¹³æ»‘ä¸‹é™ï¼Œå¸¸ç”¨äºè®­ç»ƒåæœŸ fine-tune</code></pre>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cosine_annealing(epoch, lr_max, lr_min, T_max):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""ä½™å¼¦é€€ç«"""</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lr_min <span class="op">+</span> (lr_max <span class="op">-</span> lr_min) <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> np.cos(np.pi <span class="op">*</span> epoch <span class="op">/</span> T_max)) <span class="op">/</span> <span class="dv">2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="warm-up-cosine-ç°ä»£-transformer-æ ‡é…" class="level4">
<h4 class="anchored" data-anchor-id="warm-up-cosine-ç°ä»£-transformer-æ ‡é…"><strong>4. Warm-up + Cosine (ç°ä»£ Transformer æ ‡é…)</strong></h4>
<pre><code>Warm-up é˜¶æ®µï¼ˆå‰å‡ ä¸ª epochï¼‰ï¼š
  çº¿æ€§å¢åŠ å­¦ä¹ ç‡ 0 â†’ lr_max

ä¸»è®­ç»ƒé˜¶æ®µï¼š
  ä½™å¼¦é€€ç« lr_max â†’ lr_min</code></pre>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> warmup_cosine_schedule(epoch, lr_max, warmup_epochs, total_epochs, lr_min<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Warm-up + Cosine"""</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> epoch <span class="op">&lt;</span> warmup_epochs:</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Warm-up é˜¶æ®µ</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lr_max <span class="op">*</span> (epoch <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> warmup_epochs</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cosine é˜¶æ®µ</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        progress <span class="op">=</span> (epoch <span class="op">-</span> warmup_epochs) <span class="op">/</span> (total_epochs <span class="op">-</span> warmup_epochs)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lr_min <span class="op">+</span> (lr_max <span class="op">-</span> lr_min) <span class="op">*</span> <span class="fl">0.5</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> np.cos(np.pi <span class="op">*</span> progress))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="reduce-on-plateau-åŸºäºéªŒè¯é›†" class="level4">
<h4 class="anchored" data-anchor-id="reduce-on-plateau-åŸºäºéªŒè¯é›†"><strong>5. Reduce on Plateau (åŸºäºéªŒè¯é›†)</strong></h4>
<pre><code>ç›‘æ§éªŒè¯é›† Lossï¼š

å¦‚æœ N ä¸ª epoch æ²¡æœ‰æ”¹è¿›ï¼š
  lr = lr * factor

å¾ˆå®ç”¨ï¼</code></pre>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ReduceLROnPlateau:</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, lr_init, factor<span class="op">=</span><span class="fl">0.1</span>, patience<span class="op">=</span><span class="dv">10</span>, min_lr<span class="op">=</span><span class="fl">1e-7</span>):</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lr <span class="op">=</span> lr_init</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.factor <span class="op">=</span> factor</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.patience <span class="op">=</span> patience</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.min_lr <span class="op">=</span> min_lr</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.best_loss <span class="op">=</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>, val_loss):</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">        æ ¹æ®éªŒè¯é›† Loss è°ƒæ•´å­¦ä¹ ç‡</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> val_loss <span class="op">&lt;</span> <span class="va">self</span>.best_loss:</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.best_loss <span class="op">=</span> val_loss</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.counter <span class="op">&gt;=</span> <span class="va">self</span>.patience:</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.lr <span class="op">*=</span> <span class="va">self</span>.factor</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.lr <span class="op">=</span> <span class="bu">max</span>(<span class="va">self</span>.lr, <span class="va">self</span>.min_lr)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"å­¦ä¹ ç‡å·²é™ä½åˆ° </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>lr<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.lr</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="å¯è§†åŒ–å¯¹æ¯”-1" class="level3">
<h3 class="anchored" data-anchor-id="å¯è§†åŒ–å¯¹æ¯”-1">ğŸ“ˆ å¯è§†åŒ–å¯¹æ¯”</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>epochs <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>lr_0 <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ç”Ÿæˆä¸åŒè°ƒåº¦çš„å­¦ä¹ ç‡</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>epochs_arr <span class="op">=</span> np.arange(epochs)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>lr_constant <span class="op">=</span> np.ones(epochs) <span class="op">*</span> lr_0</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>lr_step <span class="op">=</span> np.array([step_decay_schedule(e, lr_0, drop<span class="op">=</span><span class="fl">0.5</span>, epochs_drop<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> e <span class="kw">in</span> epochs_arr])</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>lr_exp <span class="op">=</span> np.array([exponential_decay(e, lr_0, decay_rate<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">for</span> e <span class="kw">in</span> epochs_arr])</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>lr_cosine <span class="op">=</span> np.array([cosine_annealing(e, lr_0, <span class="fl">1e-5</span>, <span class="dv">200</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>                      <span class="cf">for</span> e <span class="kw">in</span> epochs_arr])</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>lr_warmup_cosine <span class="op">=</span> np.array([warmup_cosine_schedule(e, lr_0, <span class="dv">10</span>, <span class="dv">200</span>, <span class="fl">1e-5</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>                             <span class="cf">for</span> e <span class="kw">in</span> epochs_arr])</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ç»˜å›¾</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>plt.semilogy(epochs_arr, lr_constant, label<span class="op">=</span><span class="st">'Constant'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>plt.semilogy(epochs_arr, lr_step, label<span class="op">=</span><span class="st">'Step Decay'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>plt.semilogy(epochs_arr, lr_exp, label<span class="op">=</span><span class="st">'Exponential Decay'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>plt.semilogy(epochs_arr, lr_cosine, label<span class="op">=</span><span class="st">'Cosine Annealing'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>plt.semilogy(epochs_arr, lr_warmup_cosine, label<span class="op">=</span><span class="st">'Warm-up + Cosine'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Learning Rate'</span>)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Learning Rate Schedules Comparison'</span>)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="æ­£åˆ™åŒ–æŠ€æœ¯-regularization" class="level2">
<h2 class="anchored" data-anchor-id="æ­£åˆ™åŒ–æŠ€æœ¯-regularization">5.7 æ­£åˆ™åŒ–æŠ€æœ¯ (Regularization)</h2>
<section id="é—®é¢˜è¿‡æ‹Ÿåˆ" class="level3">
<h3 class="anchored" data-anchor-id="é—®é¢˜è¿‡æ‹Ÿåˆ">ğŸ¯ é—®é¢˜ï¼šè¿‡æ‹Ÿåˆ</h3>
<pre><code>è®­ç»ƒé›† Loss: 0.01  âœ“
æµ‹è¯•é›† Loss: 0.5   âœ—

æ¨¡å‹è¿‡åº¦å­¦ä¹ äº†è®­ç»ƒæ•°æ®çš„å™ªå£°</code></pre>
</section>
<section id="l1-å’Œ-l2-æ­£åˆ™åŒ–" class="level3">
<h3 class="anchored" data-anchor-id="l1-å’Œ-l2-æ­£åˆ™åŒ–">ğŸ”¹ L1 å’Œ L2 æ­£åˆ™åŒ–</h3>
<p><strong>L2 æ­£åˆ™åŒ–ï¼ˆæƒé‡è¡°å‡ï¼‰</strong>ï¼š</p>
<pre><code>L_total = L_origin + Î»Â·(1/2)Â·Î£wÂ²

æ•ˆæœï¼šå€¾å‘äºè®©æƒé‡å˜å°</code></pre>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PyTorch ä¸­ç›´æ¥åœ¨ä¼˜åŒ–å™¨ä¸­æŒ‡å®š</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>, weight_decay<span class="op">=</span><span class="fl">0.01</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># æˆ–æ‰‹åŠ¨æ·»åŠ åˆ° Loss</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>L_total <span class="op">=</span> L_origin <span class="op">+</span> weight_decay <span class="op">*</span> <span class="bu">sum</span>(p<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> p <span class="kw">in</span> model.parameters())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>L1 æ­£åˆ™åŒ–</strong>ï¼š</p>
<pre><code>L_total = L_origin + Î»Â·Î£|w|

æ•ˆæœï¼šè®©ä¸€äº›æƒé‡å˜æˆ 0ï¼ˆç¨€ç–æ€§ï¼‰</code></pre>
<hr>
</section>
<section id="dropout" class="level3">
<h3 class="anchored" data-anchor-id="dropout">ğŸ”¹ Dropout â­</h3>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šè®­ç»ƒæ—¶éšæœºâ€å…³é—­â€ä¸€äº›ç¥ç»å…ƒ</p>
<pre><code>è®­ç»ƒæ—¶ (dropout = 0.5):
  xâ‚ â”€â”€ wâ‚ â”€â”€â”
  xâ‚‚ â”€â”€ âœ—   â”œâ”€ z  (éšæœºå…³é—­éƒ¨åˆ†è¿æ¥)
  xâ‚ƒ â”€â”€ wâ‚ƒ â”€â”€â”˜

é¢„æµ‹æ—¶ï¼š
  ä½¿ç”¨æ‰€æœ‰è¿æ¥ï¼Œä½†æƒé‡ä¹˜ä»¥ (1-p)
  æˆ–ä½¿ç”¨ inverted dropoutï¼Œè®­ç»ƒæ—¶å°±è°ƒæ•´</code></pre>
<p><strong>Inverted Dropout</strong> (æ¨è):</p>
<pre><code>è®­ç»ƒæ—¶ï¼š
  a_dropped = a / (1 - p)  with probability (1-p)
              0             with probability p

é¢„æµ‹æ—¶ï¼š
  ä½¿ç”¨ a ç›´æ¥ï¼ˆä¸éœ€è¦è°ƒæ•´ï¼‰</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼š - é˜²æ­¢å…±é€‚åº”ï¼ˆco-adaptationï¼‰ - å‡å°‘è¿‡æ‹Ÿåˆ - é›†æˆæ•ˆæœ</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PyTorch</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NeuralNetworkWithDropout(nn.Module):</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_size, hidden_size, dropout_rate<span class="op">=</span><span class="fl">0.5</span>):</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc1 <span class="op">=</span> nn.Linear(input_size, hidden_size)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dropout1 <span class="op">=</span> nn.Dropout(dropout_rate)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc2 <span class="op">=</span> nn.Linear(hidden_size, hidden_size)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dropout2 <span class="op">=</span> nn.Dropout(dropout_rate)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc3 <span class="op">=</span> nn.Linear(hidden_size, <span class="dv">10</span>)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.relu(<span class="va">self</span>.fc1(x))</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout1(x)  <span class="co"># è®­ç»ƒæ—¶éšæœºå…³é—­ï¼Œé¢„æµ‹æ—¶è‡ªåŠ¨è°ƒæ•´</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.relu(<span class="va">self</span>.fc2(x))</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout2(x)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc3(x)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ä½¿ç”¨</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> NeuralNetworkWithDropout(<span class="dv">784</span>, <span class="dv">128</span>, dropout_rate<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>model.train()   <span class="co"># è®­ç»ƒæ¨¡å¼ï¼ŒDropout æœ‰æ•ˆ</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">eval</span>()    <span class="co"># è¯„ä¼°æ¨¡å¼ï¼ŒDropout æ— æ•ˆ</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="dropout-æ•ˆæœ" class="level3">
<h3 class="anchored" data-anchor-id="dropout-æ•ˆæœ">ğŸ“Š Dropout æ•ˆæœ</h3>
<pre><code>ä¸ä½¿ç”¨ Dropout:          ä½¿ç”¨ Dropout:
è®­ç»ƒLoss â†“              è®­ç»ƒLoss â†˜
æµ‹è¯•Loss â†—              æµ‹è¯•Loss â†˜

è¿‡æ‹Ÿåˆ                  æ³›åŒ–æ›´å¥½</code></pre>
<hr>
</section>
<section id="early-stopping" class="level3">
<h3 class="anchored" data-anchor-id="early-stopping">ğŸ”¹ Early Stopping</h3>
<p><strong>æ€æƒ³</strong>ï¼šç›‘æ§éªŒè¯é›†ï¼Œå½“éªŒè¯é›† Loss åœæ­¢æ”¹è¿›æ—¶åœæ­¢è®­ç»ƒ</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EarlyStopping:</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, patience<span class="op">=</span><span class="dv">10</span>, min_delta<span class="op">=</span><span class="dv">0</span>, restore_best_weights<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.patience <span class="op">=</span> patience</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.min_delta <span class="op">=</span> min_delta</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.best_loss <span class="op">=</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.restore_best_weights <span class="op">=</span> restore_best_weights</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.best_weights <span class="op">=</span> <span class="va">None</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, val_loss, model):</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co">        è¿”å› True è¡¨ç¤ºåº”è¯¥åœæ­¢è®­ç»ƒ</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> val_loss <span class="op">&lt;</span> <span class="va">self</span>.best_loss <span class="op">-</span> <span class="va">self</span>.min_delta:</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.best_loss <span class="op">=</span> val_loss</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.restore_best_weights:</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.best_weights <span class="op">=</span> model.state_dict().copy()</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.counter <span class="op">&gt;=</span> <span class="va">self</span>.patience:</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>.restore_best_weights <span class="kw">and</span> <span class="va">self</span>.best_weights <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>                    model.load_state_dict(<span class="va">self</span>.best_weights)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span>  <span class="co"># åœæ­¢è®­ç»ƒ</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="co"># ä½¿ç”¨</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(num_epochs):</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># è®­ç»ƒ</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>    train_loss <span class="op">=</span> train_one_epoch()</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># éªŒè¯</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>    val_loss <span class="op">=</span> validate()</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># æ£€æŸ¥æ˜¯å¦åœæ­¢</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> early_stopping(val_loss, model):</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"åœ¨ç¬¬ </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss"> ä¸ª epoch åœæ­¢"</span>)</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="batch-normalization-bn" class="level2">
<h2 class="anchored" data-anchor-id="batch-normalization-bn">5.8 Batch Normalization (BN)</h2>
<section id="ä¸ºä»€ä¹ˆéœ€è¦-bn" class="level3">
<h3 class="anchored" data-anchor-id="ä¸ºä»€ä¹ˆéœ€è¦-bn">ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦ BNï¼Ÿ</h3>
<p><strong>é—®é¢˜ï¼šå†…éƒ¨åå˜é‡è½¬ç§» (Internal Covariate Shift)</strong></p>
<pre><code>ç¬¬1å±‚çš„è¾“å‡ºå˜åŒ– â†’ ç¬¬2å±‚çš„è¾“å…¥åˆ†å¸ƒå˜åŒ–
â†’ ç¬¬2å±‚éœ€è¦ä¸æ–­é€‚åº” â†’ è®­ç»ƒå˜æ…¢</code></pre>
</section>
<section id="batch-normalization-åŸç†" class="level3">
<h3 class="anchored" data-anchor-id="batch-normalization-åŸç†">ğŸ’¡ Batch Normalization åŸç†</h3>
<p><strong>æ ‡å‡†åŒ–æ¯ä¸ª batch</strong>ï¼š</p>
<pre><code>å¯¹æ¯ä¸ªç‰¹å¾ï¼š
  1. è®¡ç®—å‡å€¼ï¼šÎ¼_B = (1/m)Â·Î£xáµ¢
  2. è®¡ç®—æ–¹å·®ï¼šÏƒ_BÂ² = (1/m)Â·Î£(xáµ¢ - Î¼_B)Â²
  3. æ ‡å‡†åŒ–ï¼šxÌ‚áµ¢ = (xáµ¢ - Î¼_B) / âˆš(Ïƒ_BÂ² + Îµ)
  4. å°ºåº¦å’Œå¹³ç§»ï¼šyáµ¢ = Î³Â·xÌ‚áµ¢ + Î²

å…¶ä¸­ Î³ å’Œ Î² æ˜¯å¯å­¦ä¹ çš„å‚æ•°</code></pre>
</section>
<section id="bn-åœ¨å“ªé‡Œæ”¾" class="level3">
<h3 class="anchored" data-anchor-id="bn-åœ¨å“ªé‡Œæ”¾">ğŸ“ BN åœ¨å“ªé‡Œæ”¾ï¼Ÿ</h3>
<pre><code>å¸¸è§ä½ç½®ï¼š
  1. Linear â†’ BN â†’ Activation
  2. Linear â†’ Activation â†’ BN
  3. Conv â†’ BN â†’ ReLU (æ¨è)

ä¸€èˆ¬ï¼šBN åœ¨æ¿€æ´»å‡½æ•°ä¹‹å‰</code></pre>
</section>
<section id="pytorch-å®ç°" class="level3">
<h3 class="anchored" data-anchor-id="pytorch-å®ç°">ğŸ’» PyTorch å®ç°</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NeuralNetworkWithBN(nn.Module):</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_size, hidden_size):</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc1 <span class="op">=</span> nn.Linear(input_size, hidden_size)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.bn1 <span class="op">=</span> nn.BatchNorm1d(hidden_size)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc2 <span class="op">=</span> nn.Linear(hidden_size, hidden_size)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.bn2 <span class="op">=</span> nn.BatchNorm1d(hidden_size)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc3 <span class="op">=</span> nn.Linear(hidden_size, <span class="dv">10</span>)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc1(x)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.bn1(x)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.relu(x)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc2(x)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.bn2(x)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.relu(x)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc3(x)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co"># è®­ç»ƒæ—¶ BN ä½¿ç”¨ batch ç»Ÿè®¡</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="co"># æ¨ç†æ—¶ BN ä½¿ç”¨è¿è¡Œå‡å€¼å’Œæ–¹å·®</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>model.train()    <span class="co"># ä½¿ç”¨ batch ç»Ÿè®¡</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">eval</span>()     <span class="co"># ä½¿ç”¨è¿è¡Œç»Ÿè®¡</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="batch-normalization-çš„ä¼˜ç‚¹" class="level3">
<h3 class="anchored" data-anchor-id="batch-normalization-çš„ä¼˜ç‚¹">âœ… Batch Normalization çš„ä¼˜ç‚¹</h3>
<ol type="1">
<li><strong>åŠ é€Ÿæ”¶æ•›</strong>ï¼šå‡å°‘å†…éƒ¨åå˜é‡è½¬ç§»</li>
<li><strong>å…è®¸æ›´å¤§å­¦ä¹ ç‡</strong>ï¼šæ›´ç¨³å®šçš„æ¢¯åº¦</li>
<li><strong>å‡å°‘åˆå§‹åŒ–æ•æ„Ÿæ€§</strong>ï¼šå¯¹åˆå§‹åŒ–ä¸æ•æ„Ÿ</li>
<li><strong>è½»å¾®çš„æ­£åˆ™åŒ–æ•ˆæœ</strong></li>
<li><strong>ç®€åŒ–åç»­ç½‘ç»œ</strong>ï¼šå¯ä»¥ç§»é™¤ Dropout</li>
</ol>
</section>
<section id="bn-çš„ç¼ºç‚¹å’Œé™åˆ¶" class="level3">
<h3 class="anchored" data-anchor-id="bn-çš„ç¼ºç‚¹å’Œé™åˆ¶">âš ï¸ BN çš„ç¼ºç‚¹å’Œé™åˆ¶</h3>
<pre><code>é—®é¢˜ï¼š
  - Batch size å¤ªå°æ—¶æ•ˆæœå·®
  - è®­ç»ƒå’Œæ¨ç†æ—¶è¡Œä¸ºä¸åŒ
  - åœ¨ RNN ä¸­ä½¿ç”¨å›°éš¾

è§£å†³ï¼š
  - Layer Normalization (LN)
  - Group Normalization (GN)
  - Instance Normalization (IN)</code></pre>
<hr>
</section>
</section>
<section id="å®æˆ˜å®Œæ•´è®­ç»ƒæµç¨‹" class="level2">
<h2 class="anchored" data-anchor-id="å®æˆ˜å®Œæ•´è®­ç»ƒæµç¨‹">5.9 å®æˆ˜ï¼šå®Œæ•´è®­ç»ƒæµç¨‹</h2>
<section id="pytorch-å®Œæ•´ç¤ºä¾‹" class="level3">
<h3 class="anchored" data-anchor-id="pytorch-å®Œæ•´ç¤ºä¾‹">ğŸ’» PyTorch å®Œæ•´ç¤ºä¾‹</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.optim <span class="im">as</span> optim</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> DataLoader</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchvision <span class="im">import</span> datasets, transforms</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================== è¶…å‚æ•° ====================</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>BATCH_SIZE <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>LEARNING_RATE <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>WEIGHT_DECAY <span class="op">=</span> <span class="fl">1e-5</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>EPOCHS <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>DROPOUT_RATE <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>DEVICE <span class="op">=</span> torch.device(<span class="st">'cuda'</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">'cpu'</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================== æ•°æ®åŠ è½½ ====================</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>transform <span class="op">=</span> transforms.Compose([</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    transforms.ToTensor(),</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    transforms.Normalize((<span class="fl">0.1307</span>,), (<span class="fl">0.3081</span>,))</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>train_dataset <span class="op">=</span> datasets.MNIST(root<span class="op">=</span><span class="st">'./data'</span>, train<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>                               download<span class="op">=</span><span class="va">True</span>, transform<span class="op">=</span>transform)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>val_dataset <span class="op">=</span> datasets.MNIST(root<span class="op">=</span><span class="st">'./data'</span>, train<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>                             download<span class="op">=</span><span class="va">True</span>, transform<span class="op">=</span>transform)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>train_loader <span class="op">=</span> DataLoader(train_dataset, batch_size<span class="op">=</span>BATCH_SIZE,</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>                          shuffle<span class="op">=</span><span class="va">True</span>, num_workers<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>val_loader <span class="op">=</span> DataLoader(val_dataset, batch_size<span class="op">=</span>BATCH_SIZE,</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>                        shuffle<span class="op">=</span><span class="va">False</span>, num_workers<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================== å®šä¹‰æ¨¡å‹ ====================</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ImprovedNN(nn.Module):</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dropout_rate<span class="op">=</span><span class="fl">0.3</span>):</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ç¬¬1å±‚</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc1 <span class="op">=</span> nn.Linear(<span class="dv">28</span><span class="op">*</span><span class="dv">28</span>, <span class="dv">512</span>)</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.bn1 <span class="op">=</span> nn.BatchNorm1d(<span class="dv">512</span>)</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dropout1 <span class="op">=</span> nn.Dropout(dropout_rate)</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ç¬¬2å±‚</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc2 <span class="op">=</span> nn.Linear(<span class="dv">512</span>, <span class="dv">256</span>)</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.bn2 <span class="op">=</span> nn.BatchNorm1d(<span class="dv">256</span>)</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dropout2 <span class="op">=</span> nn.Dropout(dropout_rate)</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ç¬¬3å±‚</span></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc3 <span class="op">=</span> nn.Linear(<span class="dv">256</span>, <span class="dv">128</span>)</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.bn3 <span class="op">=</span> nn.BatchNorm1d(<span class="dv">128</span>)</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dropout3 <span class="op">=</span> nn.Dropout(dropout_rate)</span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># è¾“å‡ºå±‚</span></span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc4 <span class="op">=</span> nn.Linear(<span class="dv">128</span>, <span class="dv">10</span>)</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># å±•å¹³</span></span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x.view(<span class="op">-</span><span class="dv">1</span>, <span class="dv">28</span><span class="op">*</span><span class="dv">28</span>)</span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ç¬¬1å±‚</span></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc1(x)</span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.bn1(x)</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.relu(x)</span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout1(x)</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ç¬¬2å±‚</span></span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc2(x)</span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.bn2(x)</span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.relu(x)</span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout2(x)</span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ç¬¬3å±‚</span></span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc3(x)</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.bn3(x)</span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.relu(x)</span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout3(x)</span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>        <span class="co"># è¾“å‡ºå±‚</span></span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc4(x)</span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ImprovedNN(dropout_rate<span class="op">=</span>DROPOUT_RATE).to(DEVICE)</span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================== æŸå¤±å’Œä¼˜åŒ–å™¨ ====================</span></span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a>criterion <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> optim.Adam(model.parameters(),</span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a>                       lr<span class="op">=</span>LEARNING_RATE,</span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a>                       weight_decay<span class="op">=</span>WEIGHT_DECAY)</span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a><span class="co"># å­¦ä¹ ç‡è°ƒåº¦</span></span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a>scheduler <span class="op">=</span> optim.lr_scheduler.CosineAnnealingLR(</span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a>    optimizer, T_max<span class="op">=</span>EPOCHS, eta_min<span class="op">=</span><span class="fl">1e-6</span></span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Early Stopping</span></span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================== è®­ç»ƒå‡½æ•° ====================</span></span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_epoch(model, train_loader, criterion, optimizer, device):</span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""è®­ç»ƒä¸€ä¸ª epoch"""</span></span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a>    model.train()</span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a>    total_loss <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a>    correct <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb47-104"><a href="#cb47-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-105"><a href="#cb47-105" aria-hidden="true" tabindex="-1"></a>    progress_bar <span class="op">=</span> tqdm(train_loader, desc<span class="op">=</span><span class="st">'Training'</span>)</span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> images, labels <span class="kw">in</span> progress_bar:</span>
<span id="cb47-108"><a href="#cb47-108" aria-hidden="true" tabindex="-1"></a>        images, labels <span class="op">=</span> images.to(device), labels.to(device)</span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a>        <span class="co"># å‰å‘ä¼ æ’­</span></span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(images)</span>
<span id="cb47-112"><a href="#cb47-112" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> criterion(outputs, labels)</span>
<span id="cb47-113"><a href="#cb47-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-114"><a href="#cb47-114" aria-hidden="true" tabindex="-1"></a>        <span class="co"># åå‘ä¼ æ’­</span></span>
<span id="cb47-115"><a href="#cb47-115" aria-hidden="true" tabindex="-1"></a>        optimizer.zero_grad()</span>
<span id="cb47-116"><a href="#cb47-116" aria-hidden="true" tabindex="-1"></a>        loss.backward()</span>
<span id="cb47-117"><a href="#cb47-117" aria-hidden="true" tabindex="-1"></a>        optimizer.step()</span>
<span id="cb47-118"><a href="#cb47-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-119"><a href="#cb47-119" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ç»Ÿè®¡</span></span>
<span id="cb47-120"><a href="#cb47-120" aria-hidden="true" tabindex="-1"></a>        total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb47-121"><a href="#cb47-121" aria-hidden="true" tabindex="-1"></a>        _, predicted <span class="op">=</span> outputs.<span class="bu">max</span>(<span class="dv">1</span>)</span>
<span id="cb47-122"><a href="#cb47-122" aria-hidden="true" tabindex="-1"></a>        correct <span class="op">+=</span> predicted.eq(labels).<span class="bu">sum</span>().item()</span>
<span id="cb47-123"><a href="#cb47-123" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> labels.size(<span class="dv">0</span>)</span>
<span id="cb47-124"><a href="#cb47-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-125"><a href="#cb47-125" aria-hidden="true" tabindex="-1"></a>        <span class="co"># æ›´æ–°è¿›åº¦æ¡</span></span>
<span id="cb47-126"><a href="#cb47-126" aria-hidden="true" tabindex="-1"></a>        accuracy <span class="op">=</span> <span class="fl">100.</span> <span class="op">*</span> correct <span class="op">/</span> total</span>
<span id="cb47-127"><a href="#cb47-127" aria-hidden="true" tabindex="-1"></a>        progress_bar.set_postfix({</span>
<span id="cb47-128"><a href="#cb47-128" aria-hidden="true" tabindex="-1"></a>            <span class="st">'loss'</span>: <span class="ss">f'</span><span class="sc">{</span>total_loss<span class="op">/</span>(total)<span class="sc">:.3f}</span><span class="ss">'</span>,</span>
<span id="cb47-129"><a href="#cb47-129" aria-hidden="true" tabindex="-1"></a>            <span class="st">'acc'</span>: <span class="ss">f'</span><span class="sc">{</span>accuracy<span class="sc">:.2f}</span><span class="ss">%'</span></span>
<span id="cb47-130"><a href="#cb47-130" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb47-131"><a href="#cb47-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-132"><a href="#cb47-132" aria-hidden="true" tabindex="-1"></a>    avg_loss <span class="op">=</span> total_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb47-133"><a href="#cb47-133" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> <span class="fl">100.</span> <span class="op">*</span> correct <span class="op">/</span> total</span>
<span id="cb47-134"><a href="#cb47-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-135"><a href="#cb47-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> avg_loss, accuracy</span>
<span id="cb47-136"><a href="#cb47-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-137"><a href="#cb47-137" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================== éªŒè¯å‡½æ•° ====================</span></span>
<span id="cb47-138"><a href="#cb47-138" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> validate(model, val_loader, criterion, device):</span>
<span id="cb47-139"><a href="#cb47-139" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""éªŒè¯"""</span></span>
<span id="cb47-140"><a href="#cb47-140" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">eval</span>()</span>
<span id="cb47-141"><a href="#cb47-141" aria-hidden="true" tabindex="-1"></a>    total_loss <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb47-142"><a href="#cb47-142" aria-hidden="true" tabindex="-1"></a>    correct <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb47-143"><a href="#cb47-143" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb47-144"><a href="#cb47-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-145"><a href="#cb47-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb47-146"><a href="#cb47-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> images, labels <span class="kw">in</span> tqdm(val_loader, desc<span class="op">=</span><span class="st">'Validation'</span>):</span>
<span id="cb47-147"><a href="#cb47-147" aria-hidden="true" tabindex="-1"></a>            images, labels <span class="op">=</span> images.to(device), labels.to(device)</span>
<span id="cb47-148"><a href="#cb47-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-149"><a href="#cb47-149" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(images)</span>
<span id="cb47-150"><a href="#cb47-150" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, labels)</span>
<span id="cb47-151"><a href="#cb47-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-152"><a href="#cb47-152" aria-hidden="true" tabindex="-1"></a>            total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb47-153"><a href="#cb47-153" aria-hidden="true" tabindex="-1"></a>            _, predicted <span class="op">=</span> outputs.<span class="bu">max</span>(<span class="dv">1</span>)</span>
<span id="cb47-154"><a href="#cb47-154" aria-hidden="true" tabindex="-1"></a>            correct <span class="op">+=</span> predicted.eq(labels).<span class="bu">sum</span>().item()</span>
<span id="cb47-155"><a href="#cb47-155" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> labels.size(<span class="dv">0</span>)</span>
<span id="cb47-156"><a href="#cb47-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-157"><a href="#cb47-157" aria-hidden="true" tabindex="-1"></a>    avg_loss <span class="op">=</span> total_loss <span class="op">/</span> <span class="bu">len</span>(val_loader)</span>
<span id="cb47-158"><a href="#cb47-158" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> <span class="fl">100.</span> <span class="op">*</span> correct <span class="op">/</span> total</span>
<span id="cb47-159"><a href="#cb47-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-160"><a href="#cb47-160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> avg_loss, accuracy</span>
<span id="cb47-161"><a href="#cb47-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-162"><a href="#cb47-162" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================== è®­ç»ƒå¾ªç¯ ====================</span></span>
<span id="cb47-163"><a href="#cb47-163" aria-hidden="true" tabindex="-1"></a>train_losses <span class="op">=</span> []</span>
<span id="cb47-164"><a href="#cb47-164" aria-hidden="true" tabindex="-1"></a>train_accs <span class="op">=</span> []</span>
<span id="cb47-165"><a href="#cb47-165" aria-hidden="true" tabindex="-1"></a>val_losses <span class="op">=</span> []</span>
<span id="cb47-166"><a href="#cb47-166" aria-hidden="true" tabindex="-1"></a>val_accs <span class="op">=</span> []</span>
<span id="cb47-167"><a href="#cb47-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-168"><a href="#cb47-168" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(EPOCHS):</span>
<span id="cb47-169"><a href="#cb47-169" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\n</span><span class="ss">=== Epoch </span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>EPOCHS<span class="sc">}</span><span class="ss"> ==='</span>)</span>
<span id="cb47-170"><a href="#cb47-170" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'å­¦ä¹ ç‡: </span><span class="sc">{</span>optimizer<span class="sc">.</span>param_groups[<span class="dv">0</span>][<span class="st">"lr"</span>]<span class="sc">:.6f}</span><span class="ss">'</span>)</span>
<span id="cb47-171"><a href="#cb47-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-172"><a href="#cb47-172" aria-hidden="true" tabindex="-1"></a>    <span class="co"># è®­ç»ƒ</span></span>
<span id="cb47-173"><a href="#cb47-173" aria-hidden="true" tabindex="-1"></a>    train_loss, train_acc <span class="op">=</span> train_epoch(</span>
<span id="cb47-174"><a href="#cb47-174" aria-hidden="true" tabindex="-1"></a>        model, train_loader, criterion, optimizer, DEVICE</span>
<span id="cb47-175"><a href="#cb47-175" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-176"><a href="#cb47-176" aria-hidden="true" tabindex="-1"></a>    train_losses.append(train_loss)</span>
<span id="cb47-177"><a href="#cb47-177" aria-hidden="true" tabindex="-1"></a>    train_accs.append(train_acc)</span>
<span id="cb47-178"><a href="#cb47-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-179"><a href="#cb47-179" aria-hidden="true" tabindex="-1"></a>    <span class="co"># éªŒè¯</span></span>
<span id="cb47-180"><a href="#cb47-180" aria-hidden="true" tabindex="-1"></a>    val_loss, val_acc <span class="op">=</span> validate(model, val_loader, criterion, DEVICE)</span>
<span id="cb47-181"><a href="#cb47-181" aria-hidden="true" tabindex="-1"></a>    val_losses.append(val_loss)</span>
<span id="cb47-182"><a href="#cb47-182" aria-hidden="true" tabindex="-1"></a>    val_accs.append(val_acc)</span>
<span id="cb47-183"><a href="#cb47-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-184"><a href="#cb47-184" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'è®­ç»ƒ: Loss=</span><span class="sc">{</span>train_loss<span class="sc">:.4f}</span><span class="ss">, Acc=</span><span class="sc">{</span>train_acc<span class="sc">:.2f}</span><span class="ss">%'</span>)</span>
<span id="cb47-185"><a href="#cb47-185" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'éªŒè¯: Loss=</span><span class="sc">{</span>val_loss<span class="sc">:.4f}</span><span class="ss">, Acc=</span><span class="sc">{</span>val_acc<span class="sc">:.2f}</span><span class="ss">%'</span>)</span>
<span id="cb47-186"><a href="#cb47-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-187"><a href="#cb47-187" aria-hidden="true" tabindex="-1"></a>    <span class="co"># å­¦ä¹ ç‡è°ƒåº¦</span></span>
<span id="cb47-188"><a href="#cb47-188" aria-hidden="true" tabindex="-1"></a>    scheduler.step()</span>
<span id="cb47-189"><a href="#cb47-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-190"><a href="#cb47-190" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Early Stopping</span></span>
<span id="cb47-191"><a href="#cb47-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> early_stopping(val_loss, model):</span>
<span id="cb47-192"><a href="#cb47-192" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'</span><span class="ch">\n</span><span class="ss">åœ¨ç¬¬ </span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> ä¸ª epoch åœæ­¢è®­ç»ƒï¼ˆéªŒè¯é›†æ— æ”¹è¿›ï¼‰'</span>)</span>
<span id="cb47-193"><a href="#cb47-193" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb47-194"><a href="#cb47-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-195"><a href="#cb47-195" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================== å¯è§†åŒ– ====================</span></span>
<span id="cb47-196"><a href="#cb47-196" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb47-197"><a href="#cb47-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-198"><a href="#cb47-198" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb47-199"><a href="#cb47-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-200"><a href="#cb47-200" aria-hidden="true" tabindex="-1"></a>epochs_range <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(train_losses) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb47-201"><a href="#cb47-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-202"><a href="#cb47-202" aria-hidden="true" tabindex="-1"></a>ax1.plot(epochs_range, train_losses, label<span class="op">=</span><span class="st">'Train Loss'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb47-203"><a href="#cb47-203" aria-hidden="true" tabindex="-1"></a>ax1.plot(epochs_range, val_losses, label<span class="op">=</span><span class="st">'Val Loss'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb47-204"><a href="#cb47-204" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb47-205"><a href="#cb47-205" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb47-206"><a href="#cb47-206" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Loss Over Epochs'</span>)</span>
<span id="cb47-207"><a href="#cb47-207" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb47-208"><a href="#cb47-208" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb47-209"><a href="#cb47-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-210"><a href="#cb47-210" aria-hidden="true" tabindex="-1"></a>ax2.plot(epochs_range, train_accs, label<span class="op">=</span><span class="st">'Train Acc'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb47-211"><a href="#cb47-211" aria-hidden="true" tabindex="-1"></a>ax2.plot(epochs_range, val_accs, label<span class="op">=</span><span class="st">'Val Acc'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb47-212"><a href="#cb47-212" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb47-213"><a href="#cb47-213" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Accuracy (%)'</span>)</span>
<span id="cb47-214"><a href="#cb47-214" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Accuracy Over Epochs'</span>)</span>
<span id="cb47-215"><a href="#cb47-215" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb47-216"><a href="#cb47-216" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb47-217"><a href="#cb47-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-218"><a href="#cb47-218" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb47-219"><a href="#cb47-219" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb47-220"><a href="#cb47-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-221"><a href="#cb47-221" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================== æœ€ç»ˆè¯„ä¼° ====================</span></span>
<span id="cb47-222"><a href="#cb47-222" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="op">+</span> <span class="st">'='</span><span class="op">*</span><span class="dv">50</span>)</span>
<span id="cb47-223"><a href="#cb47-223" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'æœ€ç»ˆç»“æœï¼š'</span>)</span>
<span id="cb47-224"><a href="#cb47-224" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'æœ€ä½³éªŒè¯å‡†ç¡®ç‡: </span><span class="sc">{</span><span class="bu">max</span>(val_accs)<span class="sc">:.2f}</span><span class="ss">% (Epoch </span><span class="sc">{</span>val_accs<span class="sc">.</span>index(<span class="bu">max</span>(val_accs))<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb47-225"><a href="#cb47-225" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'='</span><span class="op">*</span><span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="æœ¬ç« ä½œä¸š" class="level2">
<h2 class="anchored" data-anchor-id="æœ¬ç« ä½œä¸š">ğŸ“ æœ¬ç« ä½œä¸š</h2>
<section id="ä½œä¸š-1ä¼˜åŒ–å™¨å¯¹æ¯”" class="level3">
<h3 class="anchored" data-anchor-id="ä½œä¸š-1ä¼˜åŒ–å™¨å¯¹æ¯”">ä½œä¸š 1ï¼šä¼˜åŒ–å™¨å¯¹æ¯”</h3>
<p>å®ç°ä»¥ä¸‹ä¼˜åŒ–å™¨ï¼Œåœ¨ MNIST ä¸Šå¯¹æ¯”ï¼š</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">:</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. SGD</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. SGD + Momentum</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. RMSprop</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Adam</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># è®°å½•ï¼š</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   - è¾¾åˆ° 95% å‡†ç¡®ç‡éœ€è¦çš„ epoch æ•°</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   - æœ€ç»ˆå‡†ç¡®ç‡</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   - è®­ç»ƒæ—¶é—´</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Loss æ›²çº¿å¹³æ»‘åº¦</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ç»˜åˆ¶å¯¹æ¯”å›¾è¡¨</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="ä½œä¸š-2å­¦ä¹ ç‡è°ƒåº¦å®éªŒ" class="level3">
<h3 class="anchored" data-anchor-id="ä½œä¸š-2å­¦ä¹ ç‡è°ƒåº¦å®éªŒ">ä½œä¸š 2ï¼šå­¦ä¹ ç‡è°ƒåº¦å®éªŒ</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># åœ¨åŒä¸€ä¸ªæ¨¡å‹ä¸Šå¯¹æ¯”ä¸åŒçš„å­¦ä¹ ç‡è°ƒåº¦ï¼š</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. å›ºå®šå­¦ä¹ ç‡</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Step Decay</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Exponential Decay</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Cosine Annealing</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Warm-up + Cosine</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># åˆ†æï¼š</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   - æœ€ç»ˆå‡†ç¡®ç‡</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   - æ”¶æ•›é€Ÿåº¦</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   - è®­ç»ƒç¨³å®šæ€§</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="ä½œä¸š-3æ­£åˆ™åŒ–æŠ€æœ¯å¯¹æ¯”" class="level3">
<h3 class="anchored" data-anchor-id="ä½œä¸š-3æ­£åˆ™åŒ–æŠ€æœ¯å¯¹æ¯”">ä½œä¸š 3ï¼šæ­£åˆ™åŒ–æŠ€æœ¯å¯¹æ¯”</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># åœ¨ç›¸åŒæ¶æ„ä¸Šå¯¹æ¯”ï¼š</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. æ— æ­£åˆ™åŒ–</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. L2 æ­£åˆ™åŒ– (Î»=0.001, 0.01, 0.1)</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Dropout (p=0.3, 0.5)</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Batch Normalization</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. ç»„åˆï¼ˆBN + Dropoutï¼‰</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># è§‚å¯Ÿï¼š</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   - è®­ç»ƒé›† vs æµ‹è¯•é›†æ€§èƒ½å·®è·</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   - è¿‡æ‹Ÿåˆæƒ…å†µ</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   - æ¯ç§æ–¹æ³•çš„å½±å“</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="ä½œä¸š-4å®Œæ•´é¡¹ç›®" class="level3">
<h3 class="anchored" data-anchor-id="ä½œä¸š-4å®Œæ•´é¡¹ç›®">ä½œä¸š 4ï¼šå®Œæ•´é¡¹ç›®</h3>
<p>åœ¨ CIFAR-10 æ•°æ®é›†ä¸Šæ„å»ºå®Œæ•´çš„è®­ç»ƒæµç¨‹</p>
<p><strong>è¦æ±‚</strong>ï¼š 1. å®ç°ä¸€ä¸ª 4-5 å±‚çš„æ·±åº¦ç½‘ç»œ 2. ä½¿ç”¨ Batch Normalization 3. ä½¿ç”¨ Dropout 4. é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–å™¨ï¼ˆAdam æˆ– SGD+Momentumï¼‰ 5. å®ç°å­¦ä¹ ç‡è°ƒåº¦ 6. å®ç° Early Stopping 7. è®°å½•è®­ç»ƒè¿‡ç¨‹å’Œè¯„ä¼°ç»“æœ 8. å¯è§†åŒ–è®­ç»ƒæ›²çº¿ 9. åˆ†ææ¨¡å‹æ€§èƒ½å’Œæ”¹è¿›æ–¹å‘</p>
<hr>
</section>
</section>
<section id="æœ¬ç« å…³é”®æ¦‚å¿µ" class="level2">
<h2 class="anchored" data-anchor-id="æœ¬ç« å…³é”®æ¦‚å¿µ">ğŸ”‘ æœ¬ç« å…³é”®æ¦‚å¿µ</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>æ¦‚å¿µ</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mini-batch GD</td>
<td>æ‰¹é‡æ¢¯åº¦ä¸‹é™çš„æŠ˜ä¸­</td>
</tr>
<tr class="even">
<td>Momentum</td>
<td>ä½¿ç”¨å†å²æ¢¯åº¦åŠ é€Ÿæ”¶æ•›</td>
</tr>
<tr class="odd">
<td>RMSprop</td>
<td>è‡ªé€‚åº”å­¦ä¹ ç‡</td>
</tr>
<tr class="even">
<td>Adam</td>
<td>Momentum + RMSprop çš„ç»„åˆ</td>
</tr>
<tr class="odd">
<td>Learning Rate Schedule</td>
<td>åŠ¨æ€è°ƒæ•´å­¦ä¹ ç‡</td>
</tr>
<tr class="even">
<td>Batch Normalization</td>
<td>æ ‡å‡†åŒ–ä¸­é—´å±‚è¾“å‡º</td>
</tr>
<tr class="odd">
<td>Dropout</td>
<td>éšæœºç¦ç”¨ç¥ç»å…ƒé˜²æ­¢è¿‡æ‹Ÿåˆ</td>
</tr>
<tr class="even">
<td>L1/L2 æ­£åˆ™åŒ–</td>
<td>æƒ©ç½šå¤§æƒé‡</td>
</tr>
<tr class="odd">
<td>Early Stopping</td>
<td>ç›‘æ§éªŒè¯é›†æå‰åœæ­¢</td>
</tr>
<tr class="even">
<td>Weight Decay</td>
<td>æƒé‡è¡°å‡ï¼ˆç­‰åŒ L2ï¼‰</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="ä¸‹ä¸€ç« é¢„å‘Š" class="level2">
<h2 class="anchored" data-anchor-id="ä¸‹ä¸€ç« é¢„å‘Š">ğŸ¯ ä¸‹ä¸€ç« é¢„å‘Š</h2>
<p><strong>ç¬¬å…­ç« ï¼šå·ç§¯ç¥ç»ç½‘ç»œ (Convolutional Neural Networks)</strong> - å·ç§¯æ“ä½œçš„åŸç† - æ„Ÿå—é‡å’Œå‚æ•°å…±äº« - æ± åŒ–å’Œç‰¹å¾å›¾ - ç»å…¸ CNN æ¶æ„ï¼ˆLeNet, AlexNet, VGG, ResNetï¼‰ - å®æˆ˜ï¼šå›¾åƒåˆ†ç±»</p>
<hr>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter4.html" class="pagination-link" aria-label="ç¬¬å››ç« ï¼šæ·±åº¦ç¥ç»ç½‘ç»œåŸºç¡€ (Deep Neural Networks)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">ç¬¬å››ç« ï¼šæ·±åº¦ç¥ç»ç½‘ç»œåŸºç¡€ (Deep Neural Networks)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter6.html" class="pagination-link" aria-label="ç¬¬å…­ç« ï¼šå·ç§¯ç¥ç»ç½‘ç»œ (Convolutional Neural Networks)">
        <span class="nav-page-text"><span class="chapter-title">ç¬¬å…­ç« ï¼šå·ç§¯ç¥ç»ç½‘ç»œ (Convolutional Neural Networks)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>