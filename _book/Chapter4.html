<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ç¬¬å››ç« ï¼šæ·±åº¦ç¥ç»ç½‘ç»œåŸºç¡€ (Deep Neural Networks) â€“ æ·±åº¦å­¦ä¹ å®Œæ•´æ•™ç¨‹</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter5.html" rel="next">
<link href="./Chapter3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5ea8f22911a6df30576a2a25a24cdd7a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter1.html">ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€ç¯‡</a></li><li class="breadcrumb-item"><a href="./Chapter4.html"><span class="chapter-title">ç¬¬å››ç« ï¼šæ·±åº¦ç¥ç»ç½‘ç»œåŸºç¡€ (Deep Neural Networks)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">æ·±åº¦å­¦ä¹ å®Œæ•´æ•™ç¨‹</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ğŸ“‹ è¯¾ç¨‹æ•´ä½“æ¡†æ¶</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€ç¯‡</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">æœºå™¨å­¦ä¹ å®Œæ•´è¯¾ç¨‹</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬äºŒç« ï¼šå›å½’ (Regression)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬ä¸‰ç« ï¼šåˆ†ç±»ä¸é€»è¾‘å›å½’ (Classification &amp; Logistic Regression)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter4.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">ç¬¬å››ç« ï¼šæ·±åº¦ç¥ç»ç½‘ç»œåŸºç¡€ (Deep Neural Networks)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">ç¬¬äºŒéƒ¨åˆ†ï¼šè¿›é˜¶ç¯‡</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬äº”ç« ï¼šä¼˜åŒ–ç®—æ³•ä¸è®­ç»ƒæŠ€å·§ (Optimization &amp; Training Tricks)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter6.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬å…­ç« ï¼šå·ç§¯ç¥ç»ç½‘ç»œ (Convolutional Neural Networks)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬ä¸ƒç« ï¼šå¾ªç¯ç¥ç»ç½‘ç»œ (Recurrent Neural Networks)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬å…«ç« ï¼šAttention ä¸ Transformer</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®è·µä¸åº”ç”¨</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter9.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬ä¹ç« ï¼šè¿ç§»å­¦ä¹ ä¸å¾®è°ƒ (Transfer Learning &amp; Fine-tuning)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter10.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬åç« ï¼šå¼ºåŒ–å­¦ä¹  (Reinforcement Learning)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter11.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬åä¸€ç« ï¼šæ— ç›‘ç£å­¦ä¹  (Unsupervised Learning)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter12.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬åäºŒç« ï¼šå¯è§£é‡Šæ€§ä¸å¯¹æŠ—æ”»å‡»</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter13.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ç¬¬åä¸‰ç« ï¼šå¤§è¯­è¨€æ¨¡å‹æ—¶ä»£</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ç« èŠ‚ç›®æ ‡" id="toc-ç« èŠ‚ç›®æ ‡" class="nav-link active" data-scroll-target="#ç« èŠ‚ç›®æ ‡">ğŸ“Œ ç« èŠ‚ç›®æ ‡</a></li>
  <li><a href="#ä»é€»è¾‘å›å½’åˆ°ç¥ç»ç½‘ç»œ" id="toc-ä»é€»è¾‘å›å½’åˆ°ç¥ç»ç½‘ç»œ" class="nav-link" data-scroll-target="#ä»é€»è¾‘å›å½’åˆ°ç¥ç»ç½‘ç»œ">4.1 ä»é€»è¾‘å›å½’åˆ°ç¥ç»ç½‘ç»œ</a>
  <ul class="collapse">
  <li><a href="#å›é¡¾é€»è¾‘å›å½’" id="toc-å›é¡¾é€»è¾‘å›å½’" class="nav-link" data-scroll-target="#å›é¡¾é€»è¾‘å›å½’">ğŸ”„ å›é¡¾ï¼šé€»è¾‘å›å½’</a></li>
  <li><a href="#è§£å†³æ–¹æ¡ˆå †å å¤šå±‚" id="toc-è§£å†³æ–¹æ¡ˆå †å å¤šå±‚" class="nav-link" data-scroll-target="#è§£å†³æ–¹æ¡ˆå †å å¤šå±‚">ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼šå †å å¤šå±‚</a></li>
  <li><a href="#ç¥ç»å…ƒ-neuron" id="toc-ç¥ç»å…ƒ-neuron" class="nav-link" data-scroll-target="#ç¥ç»å…ƒ-neuron">ğŸ§  ç¥ç»å…ƒ (Neuron)</a></li>
  <li><a href="#ç¥ç»ç½‘ç»œ-å¾ˆå¤šç¥ç»å…ƒçš„ç»„åˆ" id="toc-ç¥ç»ç½‘ç»œ-å¾ˆå¤šç¥ç»å…ƒçš„ç»„åˆ" class="nav-link" data-scroll-target="#ç¥ç»ç½‘ç»œ-å¾ˆå¤šç¥ç»å…ƒçš„ç»„åˆ">ğŸ•¸ï¸ ç¥ç»ç½‘ç»œ = å¾ˆå¤šç¥ç»å…ƒçš„ç»„åˆ</a></li>
  </ul></li>
  <li><a href="#å‰å‘ä¼ æ’­-forward-propagation" id="toc-å‰å‘ä¼ æ’­-forward-propagation" class="nav-link" data-scroll-target="#å‰å‘ä¼ æ’­-forward-propagation">4.2 å‰å‘ä¼ æ’­ (Forward Propagation)</a>
  <ul class="collapse">
  <li><a href="#æ•°å­¦æ¨å¯¼" id="toc-æ•°å­¦æ¨å¯¼" class="nav-link" data-scroll-target="#æ•°å­¦æ¨å¯¼">ğŸ“ æ•°å­¦æ¨å¯¼</a></li>
  <li><a href="#å…·ä½“ä¾‹å­" id="toc-å…·ä½“ä¾‹å­" class="nav-link" data-scroll-target="#å…·ä½“ä¾‹å­">ğŸ”¢ å…·ä½“ä¾‹å­</a></li>
  <li><a href="#ä»£ç å®ç°" id="toc-ä»£ç å®ç°" class="nav-link" data-scroll-target="#ä»£ç å®ç°">ğŸ’» ä»£ç å®ç°</a></li>
  </ul></li>
  <li><a href="#æ¿€æ´»å‡½æ•°-activation-functions" id="toc-æ¿€æ´»å‡½æ•°-activation-functions" class="nav-link" data-scroll-target="#æ¿€æ´»å‡½æ•°-activation-functions">4.3 æ¿€æ´»å‡½æ•° (Activation Functions)</a>
  <ul class="collapse">
  <li><a href="#ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°" id="toc-ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°" class="nav-link" data-scroll-target="#ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°">ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°ï¼Ÿ</a></li>
  <li><a href="#å¸¸è§æ¿€æ´»å‡½æ•°" id="toc-å¸¸è§æ¿€æ´»å‡½æ•°" class="nav-link" data-scroll-target="#å¸¸è§æ¿€æ´»å‡½æ•°">ğŸ”¹ å¸¸è§æ¿€æ´»å‡½æ•°</a></li>
  <li><a href="#æ¿€æ´»å‡½æ•°å¯¹æ¯”" id="toc-æ¿€æ´»å‡½æ•°å¯¹æ¯”" class="nav-link" data-scroll-target="#æ¿€æ´»å‡½æ•°å¯¹æ¯”">ğŸ“Š æ¿€æ´»å‡½æ•°å¯¹æ¯”</a></li>
  <li><a href="#æ¿€æ´»å‡½æ•°é€‰æ‹©æŒ‡å—" id="toc-æ¿€æ´»å‡½æ•°é€‰æ‹©æŒ‡å—" class="nav-link" data-scroll-target="#æ¿€æ´»å‡½æ•°é€‰æ‹©æŒ‡å—">ğŸ’¡ æ¿€æ´»å‡½æ•°é€‰æ‹©æŒ‡å—</a></li>
  </ul></li>
  <li><a href="#æŸå¤±å‡½æ•°-loss-functions" id="toc-æŸå¤±å‡½æ•°-loss-functions" class="nav-link" data-scroll-target="#æŸå¤±å‡½æ•°-loss-functions">4.4 æŸå¤±å‡½æ•° (Loss Functions)</a>
  <ul class="collapse">
  <li><a href="#å¸¸è§æŸå¤±å‡½æ•°" id="toc-å¸¸è§æŸå¤±å‡½æ•°" class="nav-link" data-scroll-target="#å¸¸è§æŸå¤±å‡½æ•°">ğŸ¯ å¸¸è§æŸå¤±å‡½æ•°</a></li>
  </ul></li>
  <li><a href="#åå‘ä¼ æ’­-backpropagation" id="toc-åå‘ä¼ æ’­-backpropagation" class="nav-link" data-scroll-target="#åå‘ä¼ æ’­-backpropagation">4.5 åå‘ä¼ æ’­ (Backpropagation)</a>
  <ul class="collapse">
  <li><a href="#æ ¸å¿ƒæ€æƒ³" id="toc-æ ¸å¿ƒæ€æƒ³" class="nav-link" data-scroll-target="#æ ¸å¿ƒæ€æƒ³">ğŸ¯ æ ¸å¿ƒæ€æƒ³</a></li>
  <li><a href="#é“¾å¼æ³•åˆ™å›é¡¾" id="toc-é“¾å¼æ³•åˆ™å›é¡¾" class="nav-link" data-scroll-target="#é“¾å¼æ³•åˆ™å›é¡¾">ğŸ“ é“¾å¼æ³•åˆ™å›é¡¾</a></li>
  <li><a href="#åå‘ä¼ æ’­æ¨å¯¼" id="toc-åå‘ä¼ æ’­æ¨å¯¼" class="nav-link" data-scroll-target="#åå‘ä¼ æ’­æ¨å¯¼">ğŸ”„ åå‘ä¼ æ’­æ¨å¯¼</a></li>
  <li><a href="#ä»£ç å®ç°-1" id="toc-ä»£ç å®ç°-1" class="nav-link" data-scroll-target="#ä»£ç å®ç°-1">ğŸ’» ä»£ç å®ç°</a></li>
  <li><a href="#å®Œæ•´è®­ç»ƒå¾ªç¯" id="toc-å®Œæ•´è®­ç»ƒå¾ªç¯" class="nav-link" data-scroll-target="#å®Œæ•´è®­ç»ƒå¾ªç¯">ğŸ” å®Œæ•´è®­ç»ƒå¾ªç¯</a></li>
  </ul></li>
  <li><a href="#åˆå§‹åŒ–ç­–ç•¥" id="toc-åˆå§‹åŒ–ç­–ç•¥" class="nav-link" data-scroll-target="#åˆå§‹åŒ–ç­–ç•¥">4.6 åˆå§‹åŒ–ç­–ç•¥</a>
  <ul class="collapse">
  <li><a href="#ä¸ºä»€ä¹ˆåˆå§‹åŒ–é‡è¦" id="toc-ä¸ºä»€ä¹ˆåˆå§‹åŒ–é‡è¦" class="nav-link" data-scroll-target="#ä¸ºä»€ä¹ˆåˆå§‹åŒ–é‡è¦">ğŸ¤” ä¸ºä»€ä¹ˆåˆå§‹åŒ–é‡è¦ï¼Ÿ</a></li>
  <li><a href="#å¥½çš„åˆå§‹åŒ–æ–¹æ³•" id="toc-å¥½çš„åˆå§‹åŒ–æ–¹æ³•" class="nav-link" data-scroll-target="#å¥½çš„åˆå§‹åŒ–æ–¹æ³•">âœ… å¥½çš„åˆå§‹åŒ–æ–¹æ³•</a></li>
  <li><a href="#å®ç°" id="toc-å®ç°" class="nav-link" data-scroll-target="#å®ç°">ğŸ’» å®ç°</a></li>
  </ul></li>
  <li><a href="#æ¢¯åº¦æ£€éªŒ-gradient-checking" id="toc-æ¢¯åº¦æ£€éªŒ-gradient-checking" class="nav-link" data-scroll-target="#æ¢¯åº¦æ£€éªŒ-gradient-checking">4.7 æ¢¯åº¦æ£€éªŒ (Gradient Checking)</a>
  <ul class="collapse">
  <li><a href="#ç›®çš„" id="toc-ç›®çš„" class="nav-link" data-scroll-target="#ç›®çš„">ğŸ¯ ç›®çš„</a></li>
  <li><a href="#æ•°å€¼æ¢¯åº¦" id="toc-æ•°å€¼æ¢¯åº¦" class="nav-link" data-scroll-target="#æ•°å€¼æ¢¯åº¦">ğŸ“ æ•°å€¼æ¢¯åº¦</a></li>
  <li><a href="#å®ç°-1" id="toc-å®ç°-1" class="nav-link" data-scroll-target="#å®ç°-1">ğŸ’» å®ç°</a></li>
  </ul></li>
  <li><a href="#ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¡†æ¶" id="toc-ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¡†æ¶" class="nav-link" data-scroll-target="#ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¡†æ¶">4.8 ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¡†æ¶</a>
  <ul class="collapse">
  <li><a href="#pytorch-å®ç°" id="toc-pytorch-å®ç°" class="nav-link" data-scroll-target="#pytorch-å®ç°">ğŸ”¥ PyTorch å®ç°</a></li>
  <li><a href="#tensorflowkeras-å®ç°" id="toc-tensorflowkeras-å®ç°" class="nav-link" data-scroll-target="#tensorflowkeras-å®ç°">ğŸŒ TensorFlow/Keras å®ç°</a></li>
  </ul></li>
  <li><a href="#å®æˆ˜mnist-æ‰‹å†™æ•°å­—è¯†åˆ«æ·±åº¦ç½‘ç»œ" id="toc-å®æˆ˜mnist-æ‰‹å†™æ•°å­—è¯†åˆ«æ·±åº¦ç½‘ç»œ" class="nav-link" data-scroll-target="#å®æˆ˜mnist-æ‰‹å†™æ•°å­—è¯†åˆ«æ·±åº¦ç½‘ç»œ">4.9 å®æˆ˜ï¼šMNIST æ‰‹å†™æ•°å­—è¯†åˆ«ï¼ˆæ·±åº¦ç½‘ç»œï¼‰</a>
  <ul class="collapse">
  <li><a href="#å®Œæ•´å®ç°" id="toc-å®Œæ•´å®ç°" class="nav-link" data-scroll-target="#å®Œæ•´å®ç°">ğŸ’» å®Œæ•´å®ç°</a></li>
  </ul></li>
  <li><a href="#æœ¬ç« ä½œä¸š" id="toc-æœ¬ç« ä½œä¸š" class="nav-link" data-scroll-target="#æœ¬ç« ä½œä¸š">ğŸ“ æœ¬ç« ä½œä¸š</a>
  <ul class="collapse">
  <li><a href="#ä½œä¸š-1ç†è®ºé¢˜" id="toc-ä½œä¸š-1ç†è®ºé¢˜" class="nav-link" data-scroll-target="#ä½œä¸š-1ç†è®ºé¢˜">ä½œä¸š 1ï¼šç†è®ºé¢˜</a></li>
  <li><a href="#ä½œä¸š-2ç¼–ç¨‹å®è·µ" id="toc-ä½œä¸š-2ç¼–ç¨‹å®è·µ" class="nav-link" data-scroll-target="#ä½œä¸š-2ç¼–ç¨‹å®è·µ">ä½œä¸š 2ï¼šç¼–ç¨‹å®è·µ</a></li>
  </ul></li>
  <li><a href="#æœ¬ç« å…³é”®æ¦‚å¿µ" id="toc-æœ¬ç« å…³é”®æ¦‚å¿µ" class="nav-link" data-scroll-target="#æœ¬ç« å…³é”®æ¦‚å¿µ">ğŸ”‘ æœ¬ç« å…³é”®æ¦‚å¿µ</a></li>
  <li><a href="#ä¸‹ä¸€ç« é¢„å‘Š" id="toc-ä¸‹ä¸€ç« é¢„å‘Š" class="nav-link" data-scroll-target="#ä¸‹ä¸€ç« é¢„å‘Š">ğŸ¯ ä¸‹ä¸€ç« é¢„å‘Š</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter1.html">ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€ç¯‡</a></li><li class="breadcrumb-item"><a href="./Chapter4.html"><span class="chapter-title">ç¬¬å››ç« ï¼šæ·±åº¦ç¥ç»ç½‘ç»œåŸºç¡€ (Deep Neural Networks)</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">ç¬¬å››ç« ï¼šæ·±åº¦ç¥ç»ç½‘ç»œåŸºç¡€ (Deep Neural Networks)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="ç« èŠ‚ç›®æ ‡" class="level2">
<h2 class="anchored" data-anchor-id="ç« èŠ‚ç›®æ ‡">ğŸ“Œ ç« èŠ‚ç›®æ ‡</h2>
<ul>
<li>ç†è§£ä»é€»è¾‘å›å½’åˆ°ç¥ç»ç½‘ç»œçš„æ¼”è¿›</li>
<li>æŒæ¡å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ç®—æ³•</li>
<li>äº†è§£å„ç§æ¿€æ´»å‡½æ•°åŠå…¶ä½œç”¨</li>
<li>å­¦ä¹ æ·±åº¦ç½‘ç»œçš„åˆå§‹åŒ–å’Œè®­ç»ƒæŠ€å·§</li>
<li>å®æˆ˜ï¼šç”¨ PyTorch/TensorFlow æ„å»ºç¥ç»ç½‘ç»œ</li>
</ul>
<hr>
</section>
<section id="ä»é€»è¾‘å›å½’åˆ°ç¥ç»ç½‘ç»œ" class="level2">
<h2 class="anchored" data-anchor-id="ä»é€»è¾‘å›å½’åˆ°ç¥ç»ç½‘ç»œ">4.1 ä»é€»è¾‘å›å½’åˆ°ç¥ç»ç½‘ç»œ</h2>
<section id="å›é¡¾é€»è¾‘å›å½’" class="level3">
<h3 class="anchored" data-anchor-id="å›é¡¾é€»è¾‘å›å½’">ğŸ”„ å›é¡¾ï¼šé€»è¾‘å›å½’</h3>
<pre><code>è¾“å…¥ x â†’ çº¿æ€§ç»„åˆ z = wÂ·x + b â†’ Sigmoid Ïƒ(z) â†’ è¾“å‡º Å·</code></pre>
<p><strong>å±€é™æ€§</strong>ï¼šåªèƒ½å­¦ä¹ çº¿æ€§å†³ç­–è¾¹ç•Œ</p>
<pre><code>ç¤ºä¾‹ï¼šXOR é—®é¢˜

è¾“å…¥          è¾“å‡º
xâ‚  xâ‚‚       y
0   0    â†’   0
0   1    â†’   1
1   0    â†’   1
1   1    â†’   0

xâ‚‚
â†‘
1 | 0   1    æ— æ³•ç”¨ä¸€æ¡ç›´çº¿åˆ†å¼€ï¼
0 | 1   0
  |_____â†’ xâ‚
  0     1</code></pre>
</section>
<section id="è§£å†³æ–¹æ¡ˆå †å å¤šå±‚" class="level3">
<h3 class="anchored" data-anchor-id="è§£å†³æ–¹æ¡ˆå †å å¤šå±‚">ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼šå †å å¤šå±‚</h3>
<p><strong>ç¥ç»ç½‘ç»œçš„æ ¸å¿ƒæ€æƒ³</strong>ï¼š</p>
<blockquote class="blockquote">
<p>ä¸€å±‚é€»è¾‘å›å½’å¤ªç®€å•ï¼Ÿé‚£å°±å å¾ˆå¤šå±‚ï¼</p>
</blockquote>
<pre><code>è¾“å…¥å±‚ â†’ éšè—å±‚1 â†’ éšè—å±‚2 â†’ ... â†’ è¾“å‡ºå±‚</code></pre>
</section>
<section id="ç¥ç»å…ƒ-neuron" class="level3">
<h3 class="anchored" data-anchor-id="ç¥ç»å…ƒ-neuron">ğŸ§  ç¥ç»å…ƒ (Neuron)</h3>
<p><strong>å•ä¸ªç¥ç»å…ƒ = é€»è¾‘å›å½’å•å…ƒ</strong></p>
<pre><code>       xâ‚ â”€â”
       xâ‚‚ â”€â”¤
       xâ‚ƒ â”€â”¼â†’ z = Î£wáµ¢xáµ¢ + b â†’ a = Ïƒ(z) â†’ è¾“å‡º
      ...  â”¤
       xâ‚™ â”€â”˜

è¾“å…¥ â†’ åŠ æƒæ±‚å’Œ â†’ æ¿€æ´»å‡½æ•° â†’ è¾“å‡º</code></pre>
<p><strong>æ•°å­¦è¡¨ç¤º</strong>ï¼š</p>
<pre><code>z = wâ‚xâ‚ + wâ‚‚xâ‚‚ + ... + wâ‚™xâ‚™ + b
a = Ïƒ(z)

å‘é‡å½¢å¼ï¼š
z = wáµ€x + b
a = Ïƒ(z)</code></pre>
</section>
<section id="ç¥ç»ç½‘ç»œ-å¾ˆå¤šç¥ç»å…ƒçš„ç»„åˆ" class="level3">
<h3 class="anchored" data-anchor-id="ç¥ç»ç½‘ç»œ-å¾ˆå¤šç¥ç»å…ƒçš„ç»„åˆ">ğŸ•¸ï¸ ç¥ç»ç½‘ç»œ = å¾ˆå¤šç¥ç»å…ƒçš„ç»„åˆ</h3>
<pre><code>è¾“å…¥å±‚        éšè—å±‚1         éšè—å±‚2        è¾“å‡ºå±‚
  xâ‚ â”€â”€â”€â”¬â”€â”€â†’ hâ‚â½Â¹â¾ â”€â”€â”€â”¬â”€â”€â†’ hâ‚â½Â²â¾ â”€â”€â”€â”¬â”€â”€â†’ Å·â‚
        â”‚              â”‚              â”‚
  xâ‚‚ â”€â”€â”€â”¼â”€â”€â†’ hâ‚‚â½Â¹â¾ â”€â”€â”€â”¼â”€â”€â†’ hâ‚‚â½Â²â¾ â”€â”€â”€â”¼â”€â”€â†’ Å·â‚‚
        â”‚              â”‚              â”‚
  xâ‚ƒ â”€â”€â”€â”¼â”€â”€â†’ hâ‚ƒâ½Â¹â¾ â”€â”€â”€â”¼â”€â”€â†’ hâ‚ƒâ½Â²â¾ â”€â”€â”€â”¼â”€â”€â†’ Å·â‚ƒ
        â”‚              â”‚              â”‚
  ...   â””â”€â”€â†’ ...   â”€â”€â”€â””â”€â”€â†’ ...   â”€â”€â”€â”˜

ç¬¬0å±‚         ç¬¬1å±‚           ç¬¬2å±‚         ç¬¬3å±‚
(è¾“å…¥)       (éšè—)         (éšè—)       (è¾“å‡º)</code></pre>
<hr>
</section>
</section>
<section id="å‰å‘ä¼ æ’­-forward-propagation" class="level2">
<h2 class="anchored" data-anchor-id="å‰å‘ä¼ æ’­-forward-propagation">4.2 å‰å‘ä¼ æ’­ (Forward Propagation)</h2>
<section id="æ•°å­¦æ¨å¯¼" class="level3">
<h3 class="anchored" data-anchor-id="æ•°å­¦æ¨å¯¼">ğŸ“ æ•°å­¦æ¨å¯¼</h3>
<p><strong>ç¬¦å·å®šä¹‰</strong>ï¼š</p>
<pre><code>L: ç½‘ç»œå±‚æ•°
nâ½Ë¡â¾: ç¬¬ l å±‚çš„ç¥ç»å…ƒæ•°é‡
wâ½Ë¡â¾: ç¬¬ l å±‚çš„æƒé‡çŸ©é˜µ
bâ½Ë¡â¾: ç¬¬ l å±‚çš„åç½®å‘é‡
aâ½Ë¡â¾: ç¬¬ l å±‚çš„æ¿€æ´»å€¼ï¼ˆè¾“å‡ºï¼‰
zâ½Ë¡â¾: ç¬¬ l å±‚çš„åŠ æƒè¾“å…¥</code></pre>
<p><strong>å•å±‚è®¡ç®—</strong>ï¼š</p>
<pre><code>zâ½Ë¡â¾ = Wâ½Ë¡â¾Â·aâ½Ë¡â»Â¹â¾ + bâ½Ë¡â¾
aâ½Ë¡â¾ = Ïƒ(zâ½Ë¡â¾)</code></pre>
</section>
<section id="å…·ä½“ä¾‹å­" class="level3">
<h3 class="anchored" data-anchor-id="å…·ä½“ä¾‹å­">ğŸ”¢ å…·ä½“ä¾‹å­</h3>
<p><strong>ç½‘ç»œç»“æ„</strong>ï¼š2 â†’ 3 â†’ 1</p>
<pre><code>è¾“å…¥å±‚ï¼š2ä¸ªç¥ç»å…ƒ [xâ‚, xâ‚‚]
éšè—å±‚ï¼š3ä¸ªç¥ç»å…ƒ [hâ‚, hâ‚‚, hâ‚ƒ]
è¾“å‡ºå±‚ï¼š1ä¸ªç¥ç»å…ƒ [Å·]</code></pre>
<p><strong>ç¬¬1å±‚ï¼ˆè¾“å…¥â†’éšè—ï¼‰</strong>ï¼š</p>
<pre><code>zâ‚â½Â¹â¾ = wâ‚â‚â½Â¹â¾xâ‚ + wâ‚â‚‚â½Â¹â¾xâ‚‚ + bâ‚â½Â¹â¾
zâ‚‚â½Â¹â¾ = wâ‚‚â‚â½Â¹â¾xâ‚ + wâ‚‚â‚‚â½Â¹â¾xâ‚‚ + bâ‚‚â½Â¹â¾
zâ‚ƒâ½Â¹â¾ = wâ‚ƒâ‚â½Â¹â¾xâ‚ + wâ‚ƒâ‚‚â½Â¹â¾xâ‚‚ + bâ‚ƒâ½Â¹â¾

aâ‚â½Â¹â¾ = Ïƒ(zâ‚â½Â¹â¾)
aâ‚‚â½Â¹â¾ = Ïƒ(zâ‚‚â½Â¹â¾)
aâ‚ƒâ½Â¹â¾ = Ïƒ(zâ‚ƒâ½Â¹â¾)

çŸ©é˜µå½¢å¼ï¼š
zâ½Â¹â¾ = Wâ½Â¹â¾Â·x + bâ½Â¹â¾

å…¶ä¸­ï¼š
     [wâ‚â‚ wâ‚â‚‚]       [bâ‚]
Wâ½Â¹â¾=[wâ‚‚â‚ wâ‚‚â‚‚]  bâ½Â¹â¾=[bâ‚‚]
     [wâ‚ƒâ‚ wâ‚ƒâ‚‚]       [bâ‚ƒ]</code></pre>
<p><strong>ç¬¬2å±‚ï¼ˆéšè—â†’è¾“å‡ºï¼‰</strong>ï¼š</p>
<pre><code>zâ½Â²â¾ = Wâ½Â²â¾Â·aâ½Â¹â¾ + bâ½Â²â¾
Å· = aâ½Â²â¾ = Ïƒ(zâ½Â²â¾)

å…¶ä¸­ï¼š
Wâ½Â²â¾ = [wâ‚ wâ‚‚ wâ‚ƒ]  (1Ã—3 çŸ©é˜µ)
bâ½Â²â¾ = [b]          (æ ‡é‡)</code></pre>
</section>
<section id="ä»£ç å®ç°" class="level3">
<h3 class="anchored" data-anchor-id="ä»£ç å®ç°">ğŸ’» ä»£ç å®ç°</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sigmoid(z):</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Sigmoid æ¿€æ´»å‡½æ•°"""</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>z))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward_propagation(X, parameters):</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">    å‰å‘ä¼ æ’­</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">    å‚æ•°ï¼š</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">        X: è¾“å…¥æ•°æ® (n_features, m_samples)</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">        parameters: å­—å…¸ï¼ŒåŒ…å« W1, b1, W2, b2</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">    è¿”å›ï¼š</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">        A2: è¾“å‡ºå±‚æ¿€æ´»å€¼</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">        cache: ä¸­é—´å€¼ï¼Œç”¨äºåå‘ä¼ æ’­</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># è·å–å‚æ•°</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    W1 <span class="op">=</span> parameters[<span class="st">'W1'</span>]</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    b1 <span class="op">=</span> parameters[<span class="st">'b1'</span>]</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    W2 <span class="op">=</span> parameters[<span class="st">'W2'</span>]</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    b2 <span class="op">=</span> parameters[<span class="st">'b2'</span>]</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ç¬¬1å±‚</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    Z1 <span class="op">=</span> np.dot(W1, X) <span class="op">+</span> b1</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    A1 <span class="op">=</span> sigmoid(Z1)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ç¬¬2å±‚</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    Z2 <span class="op">=</span> np.dot(W2, A1) <span class="op">+</span> b2</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    A2 <span class="op">=</span> sigmoid(Z2)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ä¿å­˜ä¸­é—´å€¼</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    cache <span class="op">=</span> {</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Z1'</span>: Z1,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">'A1'</span>: A1,</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Z2'</span>: Z2,</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">'A2'</span>: A2</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> A2, cache</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="co"># ç¤ºä¾‹</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="co"># åˆå§‹åŒ–å‚æ•°</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> {</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">'W1'</span>: np.random.randn(<span class="dv">3</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="fl">0.01</span>,  <span class="co"># 3Ã—2</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">'b1'</span>: np.zeros((<span class="dv">3</span>, <span class="dv">1</span>)),              <span class="co"># 3Ã—1</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">'W2'</span>: np.random.randn(<span class="dv">1</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="fl">0.01</span>,  <span class="co"># 1Ã—3</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">'b2'</span>: np.zeros((<span class="dv">1</span>, <span class="dv">1</span>))               <span class="co"># 1Ã—1</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a><span class="co"># è¾“å…¥æ•°æ®</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([[<span class="fl">1.0</span>, <span class="fl">2.0</span>],</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>              [<span class="fl">0.5</span>, <span class="fl">1.5</span>]]).T  <span class="co"># 2Ã—2 (2ä¸ªæ ·æœ¬)</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="co"># å‰å‘ä¼ æ’­</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>A2, cache <span class="op">=</span> forward_propagation(X, parameters)</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"è¾“å…¥ X:"</span>)</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">è¾“å‡º A2:"</span>)</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A2)</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">éšè—å±‚æ¿€æ´» A1:"</span>)</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cache[<span class="st">'A1'</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="æ¿€æ´»å‡½æ•°-activation-functions" class="level2">
<h2 class="anchored" data-anchor-id="æ¿€æ´»å‡½æ•°-activation-functions">4.3 æ¿€æ´»å‡½æ•° (Activation Functions)</h2>
<section id="ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°" class="level3">
<h3 class="anchored" data-anchor-id="ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°">ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°ï¼Ÿ</h3>
<p><strong>å¦‚æœæ²¡æœ‰æ¿€æ´»å‡½æ•°</strong>ï¼ˆæˆ–ä½¿ç”¨çº¿æ€§æ¿€æ´»ï¼‰ï¼š</p>
<pre><code>zâ½Â¹â¾ = Wâ½Â¹â¾x + bâ½Â¹â¾
aâ½Â¹â¾ = zâ½Â¹â¾              â† çº¿æ€§

zâ½Â²â¾ = Wâ½Â²â¾aâ½Â¹â¾ + bâ½Â²â¾
    = Wâ½Â²â¾(Wâ½Â¹â¾x + bâ½Â¹â¾) + bâ½Â²â¾
    = (Wâ½Â²â¾Wâ½Â¹â¾)x + (Wâ½Â²â¾bâ½Â¹â¾ + bâ½Â²â¾)
    = W'x + b'           â† è¿˜æ˜¯çº¿æ€§ï¼

å¤šå±‚çº¿æ€§å˜æ¢ = å•å±‚çº¿æ€§å˜æ¢
æ·±åº¦ç½‘ç»œé€€åŒ–æˆæµ…å±‚ç½‘ç»œï¼</code></pre>
<p><strong>ç»“è®º</strong>ï¼šæ¿€æ´»å‡½æ•°å¼•å…¥éçº¿æ€§ï¼Œè®©ç¥ç»ç½‘ç»œèƒ½å­¦ä¹ å¤æ‚å‡½æ•°</p>
<hr>
</section>
<section id="å¸¸è§æ¿€æ´»å‡½æ•°" class="level3">
<h3 class="anchored" data-anchor-id="å¸¸è§æ¿€æ´»å‡½æ•°">ğŸ”¹ å¸¸è§æ¿€æ´»å‡½æ•°</h3>
<section id="sigmoid" class="level4">
<h4 class="anchored" data-anchor-id="sigmoid"><strong>1. Sigmoid</strong></h4>
<pre><code>Ïƒ(z) = 1 / (1 + eâ»á¶»)

èŒƒå›´ï¼š(0, 1)
å¯¼æ•°ï¼šÏƒ'(z) = Ïƒ(z)Â·(1 - Ïƒ(z))</code></pre>
<p><strong>å›¾å½¢</strong>ï¼š</p>
<pre><code>  1 |         ____
    |       /
0.5 |      /
    |     /
  0 |____/
    |___________ z
   -5  0   5</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š - è¾“å‡ºèŒƒå›´ (0,1)ï¼Œé€‚åˆè¡¨ç¤ºæ¦‚ç‡ - å¹³æ»‘å¯å¯¼</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š - <strong>æ¢¯åº¦æ¶ˆå¤±</strong>ï¼šz å¾ˆå¤§æˆ–å¾ˆå°æ—¶ï¼Œæ¢¯åº¦æ¥è¿‘ 0 - <strong>è¾“å‡ºä¸æ˜¯é›¶ä¸­å¿ƒ</strong>ï¼šéƒ½æ˜¯æ­£æ•°ï¼Œå¯¼è‡´æƒé‡æ›´æ–°æ•ˆç‡ä½ - <strong>è®¡ç®—é‡å¤§</strong>ï¼šæœ‰æŒ‡æ•°è¿ç®—</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š - è¾“å‡ºå±‚ï¼ˆäºŒå…ƒåˆ†ç±»ï¼‰ - ä¸æ¨èåœ¨éšè—å±‚ä½¿ç”¨</p>
</section>
<section id="tanh-åŒæ›²æ­£åˆ‡" class="level4">
<h4 class="anchored" data-anchor-id="tanh-åŒæ›²æ­£åˆ‡"><strong>2. Tanh (åŒæ›²æ­£åˆ‡)</strong></h4>
<pre><code>tanh(z) = (eá¶» - eâ»á¶») / (eá¶» + eâ»á¶»)
        = 2Â·Ïƒ(2z) - 1

èŒƒå›´ï¼š(-1, 1)
å¯¼æ•°ï¼štanh'(z) = 1 - tanhÂ²(z)</code></pre>
<p><strong>å›¾å½¢</strong>ï¼š</p>
<pre><code>  1 |         ____
    |       /
  0 |      /
    |     /
 -1 |____/
    |___________ z
   -5  0   5</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š - é›¶ä¸­å¿ƒè¾“å‡º - æ¯” Sigmoid å¥½</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š - ä»æœ‰æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ - è®¡ç®—é‡å¤§</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š - RNN/LSTM ä¸­å¸¸ç”¨ - éšè—å±‚ï¼ˆä½†ç°åœ¨æ›´æ¨è ReLUï¼‰</p>
</section>
<section id="relu-rectified-linear-unit" class="level4">
<h4 class="anchored" data-anchor-id="relu-rectified-linear-unit"><strong>3. ReLU (Rectified Linear Unit)</strong> â­</h4>
<pre><code>ReLU(z) = max(0, z)

       â§ z,  å¦‚æœ z &gt; 0
     = â¨
       â© 0,  å¦‚æœ z â‰¤ 0

å¯¼æ•°ï¼šReLU'(z) = â§ 1, å¦‚æœ z &gt; 0
                 â© 0, å¦‚æœ z â‰¤ 0</code></pre>
<p><strong>å›¾å½¢</strong>ï¼š</p>
<pre><code>    |    /
    |   /
    |  /
    | /
____|/_______ z
    0</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š - âœ… <strong>è®¡ç®—ç®€å•</strong>ï¼šä¸æ¶‰åŠæŒ‡æ•°è¿ç®— - âœ… <strong>ç¼“è§£æ¢¯åº¦æ¶ˆå¤±</strong>ï¼šæ­£åŒºåŸŸæ¢¯åº¦æ’ä¸º1 - âœ… <strong>æ”¶æ•›å¿«</strong>ï¼šæ¯” Sigmoid/Tanh å¿«å¾ˆå¤š - âœ… <strong>ç¨€ç–æ¿€æ´»</strong>ï¼šçº¦50%ç¥ç»å…ƒè¢«æ¿€æ´»</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š - âŒ <strong>Dead ReLU</strong>ï¼šè´ŸåŒºåŸŸæ¢¯åº¦ä¸º0ï¼Œç¥ç»å…ƒå¯èƒ½â€æ­»äº¡â€ - âŒ è¾“å‡ºä¸æ˜¯é›¶ä¸­å¿ƒ</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š - ğŸŒŸ <strong>é»˜è®¤é¦–é€‰</strong>ï¼éšè—å±‚çš„æ ‡å‡†é€‰æ‹© - CNN ä¸­å¹¿æ³›ä½¿ç”¨</p>
</section>
<section id="leaky-relu" class="level4">
<h4 class="anchored" data-anchor-id="leaky-relu"><strong>4. Leaky ReLU</strong></h4>
<pre><code>Leaky ReLU(z) = max(Î±z, z)

              â§ z,   å¦‚æœ z &gt; 0
            = â¨
              â© Î±z,  å¦‚æœ z â‰¤ 0

é€šå¸¸ Î± = 0.01</code></pre>
<p><strong>å›¾å½¢</strong>ï¼š</p>
<pre><code>    |    /
    |   /
    |  /
    | /
___/|_______ z
  / 0</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š - è§£å†³ Dead ReLU é—®é¢˜ - è´ŸåŒºåŸŸä»æœ‰å°æ¢¯åº¦</p>
<p><strong>å˜ç§</strong>ï¼š - <strong>PReLU</strong> (Parametric ReLU)ï¼šÎ± æ˜¯å¯å­¦ä¹ çš„å‚æ•° - <strong>ELU</strong> (Exponential Linear Unit)</p>
</section>
<section id="softmax-è¾“å‡ºå±‚" class="level4">
<h4 class="anchored" data-anchor-id="softmax-è¾“å‡ºå±‚"><strong>5. Softmax</strong> (è¾“å‡ºå±‚)</h4>
<pre><code>å¯¹äº K ä¸ªç±»åˆ«ï¼š

Softmax(záµ¢) = e^záµ¢ / Î£â±¼ e^zâ±¼

æ€§è´¨ï¼š
- Î£áµ¢ Softmax(záµ¢) = 1
- è¾“å‡ºå¯è§£é‡Šä¸ºæ¦‚ç‡</code></pre>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š - å¤šåˆ†ç±»é—®é¢˜çš„è¾“å‡ºå±‚</p>
</section>
<section id="å…¶ä»–æ¿€æ´»å‡½æ•°" class="level4">
<h4 class="anchored" data-anchor-id="å…¶ä»–æ¿€æ´»å‡½æ•°"><strong>6. å…¶ä»–æ¿€æ´»å‡½æ•°</strong></h4>
<p><strong>Swish</strong> (Google 2017):</p>
<pre><code>Swish(z) = zÂ·Ïƒ(z)

ä¼˜ç‚¹ï¼šæ— ç•Œã€å¹³æ»‘ã€éå•è°ƒ</code></pre>
<p><strong>GELU</strong> (Gaussian Error Linear Unit):</p>
<pre><code>GELU(z) â‰ˆ 0.5z(1 + tanh(âˆš(2/Ï€)(z + 0.044715zÂ³)))

ç”¨äº BERTã€GPT</code></pre>
<hr>
</section>
</section>
<section id="æ¿€æ´»å‡½æ•°å¯¹æ¯”" class="level3">
<h3 class="anchored" data-anchor-id="æ¿€æ´»å‡½æ•°å¯¹æ¯”">ğŸ“Š æ¿€æ´»å‡½æ•°å¯¹æ¯”</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sigmoid(z):</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>z))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tanh(z):</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.tanh(z)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> relu(z):</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.maximum(<span class="dv">0</span>, z)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> leaky_relu(z, alpha<span class="op">=</span><span class="fl">0.01</span>):</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.maximum(alpha <span class="op">*</span> z, z)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> elu(z, alpha<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.where(z <span class="op">&gt;</span> <span class="dv">0</span>, z, alpha <span class="op">*</span> (np.exp(z) <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ç”Ÿæˆæ•°æ®</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1000</span>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co"># ç»˜å›¾</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co"># æ¿€æ´»å‡½æ•°</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>plt.plot(z, sigmoid(z), label<span class="op">=</span><span class="st">'Sigmoid'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>plt.plot(z, tanh(z), label<span class="op">=</span><span class="st">'Tanh'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>plt.plot(z, relu(z), label<span class="op">=</span><span class="st">'ReLU'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>plt.plot(z, leaky_relu(z), label<span class="op">=</span><span class="st">'Leaky ReLU'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'z'</span>)</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Activation'</span>)</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'æ¿€æ´»å‡½æ•°'</span>)</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="co"># å¯¼æ•°</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>sigmoid_derivative <span class="op">=</span> sigmoid(z) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> sigmoid(z))</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>tanh_derivative <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> tanh(z)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>relu_derivative <span class="op">=</span> (z <span class="op">&gt;</span> <span class="dv">0</span>).astype(<span class="bu">float</span>)</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>leaky_relu_derivative <span class="op">=</span> np.where(z <span class="op">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>plt.plot(z, sigmoid_derivative, label<span class="op">=</span><span class="st">'Sigmoid</span><span class="ch">\'</span><span class="st">'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>plt.plot(z, tanh_derivative, label<span class="op">=</span><span class="st">'Tanh</span><span class="ch">\'</span><span class="st">'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>plt.plot(z, relu_derivative, label<span class="op">=</span><span class="st">'ReLU</span><span class="ch">\'</span><span class="st">'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>plt.plot(z, leaky_relu_derivative, label<span class="op">=</span><span class="st">'Leaky ReLU</span><span class="ch">\'</span><span class="st">'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'z'</span>)</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Derivative'</span>)</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'æ¿€æ´»å‡½æ•°çš„å¯¼æ•°'</span>)</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a><span class="co"># ReLU å˜ç§å¯¹æ¯”</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>plt.plot(z, relu(z), label<span class="op">=</span><span class="st">'ReLU'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>plt.plot(z, leaky_relu(z), label<span class="op">=</span><span class="st">'Leaky ReLU'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>plt.plot(z, elu(z), label<span class="op">=</span><span class="st">'ELU'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'z'</span>)</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Activation'</span>)</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'ReLU å˜ç§å¯¹æ¯”'</span>)</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a><span class="co"># æ¢¯åº¦æ¶ˆå¤±é—®é¢˜æ¼”ç¤º</span></span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>z_grad <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>sigmoid_grad <span class="op">=</span> sigmoid(z_grad) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> sigmoid(z_grad))</span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>tanh_grad <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> tanh(z_grad)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>relu_grad <span class="op">=</span> (z_grad <span class="op">&gt;</span> <span class="dv">0</span>).astype(<span class="bu">float</span>)</span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>plt.plot(z_grad, sigmoid_grad, label<span class="op">=</span><span class="st">'Sigmoid'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a>plt.plot(z_grad, tanh_grad, label<span class="op">=</span><span class="st">'Tanh'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>plt.plot(z_grad, relu_grad, label<span class="op">=</span><span class="st">'ReLU'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'z'</span>)</span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Gradient'</span>)</span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'æ¢¯åº¦æ¶ˆå¤±é—®é¢˜'</span>)</span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="æ¿€æ´»å‡½æ•°é€‰æ‹©æŒ‡å—" class="level3">
<h3 class="anchored" data-anchor-id="æ¿€æ´»å‡½æ•°é€‰æ‹©æŒ‡å—">ğŸ’¡ æ¿€æ´»å‡½æ•°é€‰æ‹©æŒ‡å—</h3>
<pre><code>éšè—å±‚ï¼š
  â”œâ”€ é»˜è®¤ï¼šReLU â­
  â”œâ”€ å°è¯•ï¼šLeaky ReLU / PReLU / ELU
  â””â”€ é¿å…ï¼šSigmoid / Tanh (é™¤éç‰¹æ®Šéœ€æ±‚)

è¾“å‡ºå±‚ï¼š
  â”œâ”€ äºŒå…ƒåˆ†ç±»ï¼šSigmoid
  â”œâ”€ å¤šå…ƒåˆ†ç±»ï¼šSoftmax
  â”œâ”€ å›å½’ï¼šLinear (æ— æ¿€æ´»å‡½æ•°)
  â””â”€ ç‰¹æ®ŠèŒƒå›´ï¼šTanh (è¾“å‡º[-1,1])</code></pre>
<hr>
</section>
</section>
<section id="æŸå¤±å‡½æ•°-loss-functions" class="level2">
<h2 class="anchored" data-anchor-id="æŸå¤±å‡½æ•°-loss-functions">4.4 æŸå¤±å‡½æ•° (Loss Functions)</h2>
<section id="å¸¸è§æŸå¤±å‡½æ•°" class="level3">
<h3 class="anchored" data-anchor-id="å¸¸è§æŸå¤±å‡½æ•°">ğŸ¯ å¸¸è§æŸå¤±å‡½æ•°</h3>
<section id="å›å½’é—®é¢˜" class="level4">
<h4 class="anchored" data-anchor-id="å›å½’é—®é¢˜"><strong>1. å›å½’é—®é¢˜</strong></h4>
<p><strong>Mean Squared Error (MSE)</strong>:</p>
<pre><code>L = (1/N) Î£(Å·â¿ - yâ¿)Â²</code></pre>
<p><strong>Mean Absolute Error (MAE)</strong>:</p>
<pre><code>L = (1/N) Î£|Å·â¿ - yâ¿|</code></pre>
<p><strong>Huber Loss</strong> (ç»“åˆ MSE å’Œ MAE):</p>
<pre><code>        â§ 0.5Â·(y - Å·)Â²,           if |y - Å·| â‰¤ Î´
L_Î´(y,Å·)=â¨
        â© Î´Â·(|y - Å·| - 0.5Â·Î´),   otherwise</code></pre>
</section>
<section id="äºŒå…ƒåˆ†ç±»" class="level4">
<h4 class="anchored" data-anchor-id="äºŒå…ƒåˆ†ç±»"><strong>2. äºŒå…ƒåˆ†ç±»</strong></h4>
<p><strong>Binary Cross Entropy</strong>:</p>
<pre><code>L = -(1/N) Î£[yâ¿Â·log(Å·â¿) + (1-yâ¿)Â·log(1-Å·â¿)]</code></pre>
</section>
<section id="å¤šå…ƒåˆ†ç±»" class="level4">
<h4 class="anchored" data-anchor-id="å¤šå…ƒåˆ†ç±»"><strong>3. å¤šå…ƒåˆ†ç±»</strong></h4>
<p><strong>Categorical Cross Entropy</strong>:</p>
<pre><code>L = -(1/N) Î£Î£ yáµ¢â¿Â·log(Å·áµ¢â¿)
           n i

å…¶ä¸­ yáµ¢â¿ æ˜¯ one-hot ç¼–ç </code></pre>
<hr>
</section>
</section>
</section>
<section id="åå‘ä¼ æ’­-backpropagation" class="level2">
<h2 class="anchored" data-anchor-id="åå‘ä¼ æ’­-backpropagation">4.5 åå‘ä¼ æ’­ (Backpropagation)</h2>
<section id="æ ¸å¿ƒæ€æƒ³" class="level3">
<h3 class="anchored" data-anchor-id="æ ¸å¿ƒæ€æƒ³">ğŸ¯ æ ¸å¿ƒæ€æƒ³</h3>
<blockquote class="blockquote">
<p>åå‘ä¼ æ’­ = é“¾å¼æ³•åˆ™ + ä»åå¾€å‰è®¡ç®—æ¢¯åº¦</p>
</blockquote>
<p><strong>ç›®æ ‡</strong>ï¼šè®¡ç®— âˆ‚L/âˆ‚Wâ½Ë¡â¾ å’Œ âˆ‚L/âˆ‚bâ½Ë¡â¾</p>
</section>
<section id="é“¾å¼æ³•åˆ™å›é¡¾" class="level3">
<h3 class="anchored" data-anchor-id="é“¾å¼æ³•åˆ™å›é¡¾">ğŸ“ é“¾å¼æ³•åˆ™å›é¡¾</h3>
<pre><code>å¦‚æœ y = f(u) ä¸” u = g(x)
åˆ™ dy/dx = (dy/du)Â·(du/dx)

ä¾‹å­ï¼š
y = (xÂ² + 1)Â³
ä»¤ u = xÂ² + 1, åˆ™ y = uÂ³

dy/dx = (dy/du)Â·(du/dx)
      = 3uÂ²Â·2x
      = 3(xÂ²+1)Â²Â·2x</code></pre>
</section>
<section id="åå‘ä¼ æ’­æ¨å¯¼" class="level3">
<h3 class="anchored" data-anchor-id="åå‘ä¼ æ’­æ¨å¯¼">ğŸ”„ åå‘ä¼ æ’­æ¨å¯¼</h3>
<p><strong>ç½‘ç»œç»“æ„</strong>ï¼šè¾“å…¥ â†’ éšè—å±‚ â†’ è¾“å‡ºå±‚</p>
<pre><code>å‰å‘ä¼ æ’­ï¼š
  zâ½Â¹â¾ = Wâ½Â¹â¾x + bâ½Â¹â¾
  aâ½Â¹â¾ = Ïƒ(zâ½Â¹â¾)
  zâ½Â²â¾ = Wâ½Â²â¾aâ½Â¹â¾ + bâ½Â²â¾
  aâ½Â²â¾ = Ïƒ(zâ½Â²â¾) = Å·

æŸå¤±ï¼š
  L = (y - Å·)Â²</code></pre>
<p><strong>åå‘ä¼ æ’­</strong>ï¼š</p>
<p><strong>è¾“å‡ºå±‚</strong>ï¼š</p>
<pre><code>âˆ‚L/âˆ‚Å· = -2(y - Å·)

âˆ‚L/âˆ‚zâ½Â²â¾ = âˆ‚L/âˆ‚Å· Â· âˆ‚Å·/âˆ‚zâ½Â²â¾
         = âˆ‚L/âˆ‚Å· Â· Ïƒ'(zâ½Â²â¾)

âˆ‚L/âˆ‚Wâ½Â²â¾ = âˆ‚L/âˆ‚zâ½Â²â¾ Â· âˆ‚zâ½Â²â¾/âˆ‚Wâ½Â²â¾
         = âˆ‚L/âˆ‚zâ½Â²â¾ Â· aâ½Â¹â¾áµ€

âˆ‚L/âˆ‚bâ½Â²â¾ = âˆ‚L/âˆ‚zâ½Â²â¾</code></pre>
<p><strong>éšè—å±‚</strong>ï¼š</p>
<pre><code>âˆ‚L/âˆ‚aâ½Â¹â¾ = (Wâ½Â²â¾)áµ€ Â· âˆ‚L/âˆ‚zâ½Â²â¾

âˆ‚L/âˆ‚zâ½Â¹â¾ = âˆ‚L/âˆ‚aâ½Â¹â¾ âŠ™ Ïƒ'(zâ½Â¹â¾)
         (âŠ™ è¡¨ç¤ºé€å…ƒç´ ä¹˜æ³•)

âˆ‚L/âˆ‚Wâ½Â¹â¾ = âˆ‚L/âˆ‚zâ½Â¹â¾ Â· xáµ€

âˆ‚L/âˆ‚bâ½Â¹â¾ = âˆ‚L/âˆ‚zâ½Â¹â¾</code></pre>
</section>
<section id="ä»£ç å®ç°-1" class="level3">
<h3 class="anchored" data-anchor-id="ä»£ç å®ç°-1">ğŸ’» ä»£ç å®ç°</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward_propagation(X, Y, parameters, cache):</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">    åå‘ä¼ æ’­</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">    å‚æ•°ï¼š</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">        X: è¾“å…¥ (n_features, m_samples)</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Y: çœŸå®æ ‡ç­¾ (1, m_samples)</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">        parameters: æƒé‡å’Œåç½®</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">        cache: å‰å‘ä¼ æ’­çš„ä¸­é—´å€¼</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co">    è¿”å›ï¼š</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co">        gradients: æ¢¯åº¦å­—å…¸</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> X.shape[<span class="dv">1</span>]  <span class="co"># æ ·æœ¬æ•°</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># è·å–å‚æ•°</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    W1 <span class="op">=</span> parameters[<span class="st">'W1'</span>]</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    W2 <span class="op">=</span> parameters[<span class="st">'W2'</span>]</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># è·å–å‰å‘ä¼ æ’­çš„å€¼</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    A1 <span class="op">=</span> cache[<span class="st">'A1'</span>]</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    A2 <span class="op">=</span> cache[<span class="st">'A2'</span>]</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># è¾“å‡ºå±‚æ¢¯åº¦</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    dZ2 <span class="op">=</span> A2 <span class="op">-</span> Y  <span class="co"># å¯¹äº sigmoid + MSE</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    dW2 <span class="op">=</span> (<span class="dv">1</span><span class="op">/</span>m) <span class="op">*</span> np.dot(dZ2, A1.T)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    db2 <span class="op">=</span> (<span class="dv">1</span><span class="op">/</span>m) <span class="op">*</span> np.<span class="bu">sum</span>(dZ2, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># éšè—å±‚æ¢¯åº¦</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    dA1 <span class="op">=</span> np.dot(W2.T, dZ2)</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>    dZ1 <span class="op">=</span> dA1 <span class="op">*</span> A1 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> A1)  <span class="co"># sigmoid çš„å¯¼æ•°</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    dW1 <span class="op">=</span> (<span class="dv">1</span><span class="op">/</span>m) <span class="op">*</span> np.dot(dZ1, X.T)</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    db1 <span class="op">=</span> (<span class="dv">1</span><span class="op">/</span>m) <span class="op">*</span> np.<span class="bu">sum</span>(dZ1, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>    gradients <span class="op">=</span> {</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">'dW1'</span>: dW1,</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">'db1'</span>: db1,</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">'dW2'</span>: dW2,</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">'db2'</span>: db2</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> gradients</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update_parameters(parameters, gradients, learning_rate):</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a><span class="co">    æ›´æ–°å‚æ•°</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>    parameters[<span class="st">'W1'</span>] <span class="op">-=</span> learning_rate <span class="op">*</span> gradients[<span class="st">'dW1'</span>]</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>    parameters[<span class="st">'b1'</span>] <span class="op">-=</span> learning_rate <span class="op">*</span> gradients[<span class="st">'db1'</span>]</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>    parameters[<span class="st">'W2'</span>] <span class="op">-=</span> learning_rate <span class="op">*</span> gradients[<span class="st">'dW2'</span>]</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>    parameters[<span class="st">'b2'</span>] <span class="op">-=</span> learning_rate <span class="op">*</span> gradients[<span class="st">'db2'</span>]</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parameters</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="å®Œæ•´è®­ç»ƒå¾ªç¯" class="level3">
<h3 class="anchored" data-anchor-id="å®Œæ•´è®­ç»ƒå¾ªç¯">ğŸ” å®Œæ•´è®­ç»ƒå¾ªç¯</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_neural_network(X, Y, hidden_size<span class="op">=</span><span class="dv">4</span>, learning_rate<span class="op">=</span><span class="fl">0.01</span>, epochs<span class="op">=</span><span class="dv">10000</span>):</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">    è®­ç»ƒç¥ç»ç½‘ç»œ</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    n_x <span class="op">=</span> X.shape[<span class="dv">0</span>]  <span class="co"># è¾“å…¥ç‰¹å¾æ•°</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    n_y <span class="op">=</span> Y.shape[<span class="dv">0</span>]  <span class="co"># è¾“å‡ºæ•°</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># åˆå§‹åŒ–å‚æ•°</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">42</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    parameters <span class="op">=</span> {</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'W1'</span>: np.random.randn(hidden_size, n_x) <span class="op">*</span> <span class="fl">0.01</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'b1'</span>: np.zeros((hidden_size, <span class="dv">1</span>)),</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'W2'</span>: np.random.randn(n_y, hidden_size) <span class="op">*</span> <span class="fl">0.01</span>,</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'b2'</span>: np.zeros((n_y, <span class="dv">1</span>))</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    losses <span class="op">=</span> []</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(epochs):</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># å‰å‘ä¼ æ’­</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>        A2, cache <span class="op">=</span> forward_propagation(X, parameters)</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># è®¡ç®—æŸå¤±</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> np.mean((A2 <span class="op">-</span> Y) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>        losses.append(loss)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># åå‘ä¼ æ’­</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>        gradients <span class="op">=</span> backward_propagation(X, Y, parameters, cache)</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># æ›´æ–°å‚æ•°</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>        parameters <span class="op">=</span> update_parameters(parameters, gradients, learning_rate)</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># æ‰“å°è¿›åº¦</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">1000</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Epoch </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">: Loss = </span><span class="sc">{</span>loss<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parameters, losses</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a><span class="co"># ç¤ºä¾‹ï¼šè§£å†³ XOR é—®é¢˜</span></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]])</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>parameters, losses <span class="op">=</span> train_neural_network(</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>    X, Y,</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>    hidden_size<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>    learning_rate<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>    epochs<span class="op">=</span><span class="dv">10000</span></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a><span class="co"># æµ‹è¯•</span></span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>A2, _ <span class="op">=</span> forward_propagation(X, parameters)</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">è¾“å…¥:"</span>)</span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.T)</span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">é¢„æµ‹:"</span>)</span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A2.T)</span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">çœŸå®æ ‡ç­¾:"</span>)</span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Y.T)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>è¾“å‡º</strong>ï¼š</p>
<pre><code>Epoch 0: Loss = 0.250615
Epoch 1000: Loss = 0.062439
Epoch 2000: Loss = 0.013152
Epoch 3000: Loss = 0.005862
Epoch 4000: Loss = 0.003494
Epoch 5000: Loss = 0.002388
Epoch 6000: Loss = 0.001756
Epoch 7000: Loss = 0.001353
Epoch 8000: Loss = 0.001081
Epoch 9000: Loss = 0.000887

è¾“å…¥:
[[0 0]
 [0 1]
 [1 0]
 [1 1]]

é¢„æµ‹:
[[0.02458917]
 [0.97201347]
 [0.97412658]
 [0.02907213]]

çœŸå®æ ‡ç­¾:
[[0]
 [1]
 [1]
 [0]]</code></pre>
<p>æˆåŠŸè§£å†³äº† XOR é—®é¢˜ï¼ğŸ‰</p>
<hr>
</section>
</section>
<section id="åˆå§‹åŒ–ç­–ç•¥" class="level2">
<h2 class="anchored" data-anchor-id="åˆå§‹åŒ–ç­–ç•¥">4.6 åˆå§‹åŒ–ç­–ç•¥</h2>
<section id="ä¸ºä»€ä¹ˆåˆå§‹åŒ–é‡è¦" class="level3">
<h3 class="anchored" data-anchor-id="ä¸ºä»€ä¹ˆåˆå§‹åŒ–é‡è¦">ğŸ¤” ä¸ºä»€ä¹ˆåˆå§‹åŒ–é‡è¦ï¼Ÿ</h3>
<p><strong>å…¨é›¶åˆå§‹åŒ–</strong>ï¼š</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> np.zeros((n_out, n_in))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>é—®é¢˜</strong>ï¼šæ‰€æœ‰ç¥ç»å…ƒå­¦åˆ°ç›¸åŒçš„ç‰¹å¾ï¼ˆå¯¹ç§°æ€§é—®é¢˜ï¼‰</p>
<p><strong>éšæœºåˆå§‹åŒ–</strong>ï¼š</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> np.random.randn(n_out, n_in)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>é—®é¢˜</strong>ï¼šæ–¹å·®å¯èƒ½å¤ªå¤§æˆ–å¤ªå°</p>
</section>
<section id="å¥½çš„åˆå§‹åŒ–æ–¹æ³•" class="level3">
<h3 class="anchored" data-anchor-id="å¥½çš„åˆå§‹åŒ–æ–¹æ³•">âœ… å¥½çš„åˆå§‹åŒ–æ–¹æ³•</h3>
<section id="xavier-åˆå§‹åŒ–-glorot" class="level4">
<h4 class="anchored" data-anchor-id="xavier-åˆå§‹åŒ–-glorot"><strong>1. Xavier åˆå§‹åŒ–</strong> (Glorot)</h4>
<p><strong>é€‚ç”¨äº</strong>ï¼šSigmoid / Tanh</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> np.random.randn(n_out, n_in) <span class="op">*</span> np.sqrt(<span class="dv">1</span> <span class="op">/</span> n_in)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># æˆ–</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> np.random.randn(n_out, n_in) <span class="op">*</span> np.sqrt(<span class="dv">2</span> <span class="op">/</span> (n_in <span class="op">+</span> n_out))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>åŸç†</strong>ï¼šä¿æŒæ–¹å·®åœ¨å„å±‚ä¹‹é—´å¹³è¡¡</p>
</section>
<section id="he-åˆå§‹åŒ–" class="level4">
<h4 class="anchored" data-anchor-id="he-åˆå§‹åŒ–"><strong>2. He åˆå§‹åŒ–</strong></h4>
<p><strong>é€‚ç”¨äº</strong>ï¼šReLU åŠå…¶å˜ç§</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> np.random.randn(n_out, n_in) <span class="op">*</span> np.sqrt(<span class="dv">2</span> <span class="op">/</span> n_in)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>åŸç†</strong>ï¼šè€ƒè™‘ ReLU ä¼šâ€æ€æ­»â€ä¸€åŠç¥ç»å…ƒ</p>
</section>
</section>
<section id="å®ç°" class="level3">
<h3 class="anchored" data-anchor-id="å®ç°">ğŸ’» å®ç°</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_parameters_xavier(layer_dims):</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Xavier åˆå§‹åŒ–</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">    å‚æ•°ï¼š</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co">        layer_dims: åˆ—è¡¨ï¼Œæ¯å±‚çš„ç¥ç»å…ƒæ•°é‡</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">                   ä¾‹å¦‚ [784, 128, 64, 10]</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    parameters <span class="op">=</span> {}</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    L <span class="op">=</span> <span class="bu">len</span>(layer_dims)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, L):</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>        parameters[<span class="ss">f'W</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> np.random.randn(</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>            layer_dims[l],</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>            layer_dims[l<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">*</span> np.sqrt(<span class="dv">1</span> <span class="op">/</span> layer_dims[l<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>        parameters[<span class="ss">f'b</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> np.zeros((layer_dims[l], <span class="dv">1</span>))</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parameters</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_parameters_he(layer_dims):</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="co">    He åˆå§‹åŒ–</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    parameters <span class="op">=</span> {}</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>    L <span class="op">=</span> <span class="bu">len</span>(layer_dims)</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, L):</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>        parameters[<span class="ss">f'W</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> np.random.randn(</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>            layer_dims[l],</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>            layer_dims[l<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">*</span> np.sqrt(<span class="dv">2</span> <span class="op">/</span> layer_dims[l<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>        parameters[<span class="ss">f'b</span><span class="sc">{</span>l<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> np.zeros((layer_dims[l], <span class="dv">1</span>))</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parameters</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="æ¢¯åº¦æ£€éªŒ-gradient-checking" class="level2">
<h2 class="anchored" data-anchor-id="æ¢¯åº¦æ£€éªŒ-gradient-checking">4.7 æ¢¯åº¦æ£€éªŒ (Gradient Checking)</h2>
<section id="ç›®çš„" class="level3">
<h3 class="anchored" data-anchor-id="ç›®çš„">ğŸ¯ ç›®çš„</h3>
<p>éªŒè¯åå‘ä¼ æ’­çš„å®ç°æ˜¯å¦æ­£ç¡®</p>
</section>
<section id="æ•°å€¼æ¢¯åº¦" class="level3">
<h3 class="anchored" data-anchor-id="æ•°å€¼æ¢¯åº¦">ğŸ“ æ•°å€¼æ¢¯åº¦</h3>
<pre><code>f'(Î¸) â‰ˆ [f(Î¸ + Îµ) - f(Î¸ - Îµ)] / (2Îµ)

é€šå¸¸ Îµ = 10â»â·</code></pre>
</section>
<section id="å®ç°-1" class="level3">
<h3 class="anchored" data-anchor-id="å®ç°-1">ğŸ’» å®ç°</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gradient_check(parameters, gradients, X, Y, epsilon<span class="op">=</span><span class="fl">1e-7</span>):</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">    æ¢¯åº¦æ£€éªŒ</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">    è¿”å›ï¼š</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co">        difference: æ•°å€¼æ¢¯åº¦å’Œè§£ææ¢¯åº¦çš„ç›¸å¯¹å·®å¼‚</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># å°†å‚æ•°å±•å¹³ä¸ºå‘é‡</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    parameters_values, _ <span class="op">=</span> dictionary_to_vector(parameters)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    grad <span class="op">=</span> gradients_to_vector(gradients)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    num_parameters <span class="op">=</span> parameters_values.shape[<span class="dv">0</span>]</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># è®¡ç®—æ•°å€¼æ¢¯åº¦</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    J_plus <span class="op">=</span> np.zeros((num_parameters, <span class="dv">1</span>))</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    J_minus <span class="op">=</span> np.zeros((num_parameters, <span class="dv">1</span>))</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    gradapprox <span class="op">=</span> np.zeros((num_parameters, <span class="dv">1</span>))</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_parameters):</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># è®¡ç®— J_plus[i]</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>        thetaplus <span class="op">=</span> np.copy(parameters_values)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>        thetaplus[i][<span class="dv">0</span>] <span class="op">+=</span> epsilon</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>        J_plus[i] <span class="op">=</span> forward_propagation_cost(X, Y, vector_to_dictionary(thetaplus))</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># è®¡ç®— J_minus[i]</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>        thetaminus <span class="op">=</span> np.copy(parameters_values)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>        thetaminus[i][<span class="dv">0</span>] <span class="op">-=</span> epsilon</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>        J_minus[i] <span class="op">=</span> forward_propagation_cost(X, Y, vector_to_dictionary(thetaminus))</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># è®¡ç®—æ•°å€¼æ¢¯åº¦</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>        gradapprox[i] <span class="op">=</span> (J_plus[i] <span class="op">-</span> J_minus[i]) <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> epsilon)</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># è®¡ç®—ç›¸å¯¹å·®å¼‚</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>    numerator <span class="op">=</span> np.linalg.norm(grad <span class="op">-</span> gradapprox)</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    denominator <span class="op">=</span> np.linalg.norm(grad) <span class="op">+</span> np.linalg.norm(gradapprox)</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    difference <span class="op">=</span> numerator <span class="op">/</span> denominator</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> difference <span class="op">&gt;</span> <span class="fl">2e-7</span>:</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"âš ï¸  æ¢¯åº¦æ£€éªŒå¤±è´¥ï¼å·®å¼‚ = </span><span class="sc">{</span>difference<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"âœ… æ¢¯åº¦æ£€éªŒé€šè¿‡ï¼å·®å¼‚ = </span><span class="sc">{</span>difference<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> difference</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¡†æ¶" class="level2">
<h2 class="anchored" data-anchor-id="ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¡†æ¶">4.8 ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¡†æ¶</h2>
<section id="pytorch-å®ç°" class="level3">
<h3 class="anchored" data-anchor-id="pytorch-å®ç°">ğŸ”¥ PyTorch å®ç°</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.optim <span class="im">as</span> optim</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> DataLoader, TensorDataset</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. å®šä¹‰ç½‘ç»œ</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NeuralNetwork(nn.Module):</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_size, hidden_size, output_size):</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(NeuralNetwork, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc1 <span class="op">=</span> nn.Linear(input_size, hidden_size)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.relu <span class="op">=</span> nn.ReLU()</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc2 <span class="op">=</span> nn.Linear(hidden_size, output_size)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.sigmoid <span class="op">=</span> nn.Sigmoid()</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc1(x)</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.relu(x)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc2(x)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.sigmoid(x)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. å‡†å¤‡æ•°æ®</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> torch.tensor([[<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">1</span>]], dtype<span class="op">=</span>torch.float32)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> torch.tensor([[<span class="dv">0</span>], [<span class="dv">1</span>], [<span class="dv">1</span>], [<span class="dv">0</span>]], dtype<span class="op">=</span>torch.float32)</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. åˆ›å»ºæ¨¡å‹</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> NeuralNetwork(input_size<span class="op">=</span><span class="dv">2</span>, hidden_size<span class="op">=</span><span class="dv">4</span>, output_size<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. å®šä¹‰æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>criterion <span class="op">=</span> nn.MSELoss()</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. è®­ç»ƒ</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>epochs <span class="op">=</span> <span class="dv">5000</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(epochs):</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># å‰å‘ä¼ æ’­</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>    outputs <span class="op">=</span> model(X_train)</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> criterion(outputs, y_train)</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># åå‘ä¼ æ’­</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>    optimizer.zero_grad()  <span class="co"># æ¸…é›¶æ¢¯åº¦</span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>    loss.backward()        <span class="co"># è®¡ç®—æ¢¯åº¦</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>    optimizer.step()       <span class="co"># æ›´æ–°å‚æ•°</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">500</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'Epoch [</span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>epochs<span class="sc">}</span><span class="ss">], Loss: </span><span class="sc">{</span>loss<span class="sc">.</span>item()<span class="sc">:.6f}</span><span class="ss">'</span>)</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. æµ‹è¯•</span></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> model(X_train)</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">é¢„æµ‹ç»“æœ:"</span>)</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(predictions.numpy())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="tensorflowkeras-å®ç°" class="level3">
<h3 class="anchored" data-anchor-id="tensorflowkeras-å®ç°">ğŸŒ TensorFlow/Keras å®ç°</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. å‡†å¤‡æ•°æ®</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">1</span>]])</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> np.array([[<span class="dv">0</span>], [<span class="dv">1</span>], [<span class="dv">1</span>], [<span class="dv">0</span>]])</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. æ„å»ºæ¨¡å‹</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential([</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    keras.layers.Dense(<span class="dv">4</span>, activation<span class="op">=</span><span class="st">'relu'</span>, input_shape<span class="op">=</span>(<span class="dv">2</span>,)),</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    keras.layers.Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. ç¼–è¯‘æ¨¡å‹</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    optimizer<span class="op">=</span><span class="st">'adam'</span>,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    loss<span class="op">=</span><span class="st">'mse'</span>,</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    metrics<span class="op">=</span>[<span class="st">'accuracy'</span>]</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. è®­ç»ƒ</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>    X_train, y_train,</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>    epochs<span class="op">=</span><span class="dv">5000</span>,</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">0</span>  <span class="co"># ä¸æ‰“å°è®­ç»ƒè¿‡ç¨‹</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. è¯„ä¼°</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>loss, accuracy <span class="op">=</span> model.evaluate(X_train, y_train, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Loss: </span><span class="sc">{</span>loss<span class="sc">:.6f}</span><span class="ss">'</span>)</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. é¢„æµ‹</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> model.predict(X_train)</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">é¢„æµ‹ç»“æœ:"</span>)</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(predictions)</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. æŸ¥çœ‹æ¨¡å‹ç»“æ„</span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="å®æˆ˜mnist-æ‰‹å†™æ•°å­—è¯†åˆ«æ·±åº¦ç½‘ç»œ" class="level2">
<h2 class="anchored" data-anchor-id="å®æˆ˜mnist-æ‰‹å†™æ•°å­—è¯†åˆ«æ·±åº¦ç½‘ç»œ">4.9 å®æˆ˜ï¼šMNIST æ‰‹å†™æ•°å­—è¯†åˆ«ï¼ˆæ·±åº¦ç½‘ç»œï¼‰</h2>
<section id="å®Œæ•´å®ç°" class="level3">
<h3 class="anchored" data-anchor-id="å®Œæ•´å®ç°">ğŸ’» å®Œæ•´å®ç°</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.optim <span class="im">as</span> optim</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> DataLoader</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchvision <span class="im">import</span> datasets, transforms</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. æ•°æ®åŠ è½½å’Œé¢„å¤„ç†</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>transform <span class="op">=</span> transforms.Compose([</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    transforms.ToTensor(),</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    transforms.Normalize((<span class="fl">0.1307</span>,), (<span class="fl">0.3081</span>,))  <span class="co"># MNIST çš„å‡å€¼å’Œæ ‡å‡†å·®</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>train_dataset <span class="op">=</span> datasets.MNIST(</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    root<span class="op">=</span><span class="st">'./data'</span>,</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    train<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    download<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    transform<span class="op">=</span>transform</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>test_dataset <span class="op">=</span> datasets.MNIST(</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    root<span class="op">=</span><span class="st">'./data'</span>,</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    train<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    download<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    transform<span class="op">=</span>transform</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>train_loader <span class="op">=</span> DataLoader(train_dataset, batch_size<span class="op">=</span><span class="dv">64</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>test_loader <span class="op">=</span> DataLoader(test_dataset, batch_size<span class="op">=</span><span class="dv">1000</span>, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. å®šä¹‰æ·±åº¦ç¥ç»ç½‘ç»œ</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DeepNN(nn.Module):</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(DeepNN, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc1 <span class="op">=</span> nn.Linear(<span class="dv">28</span><span class="op">*</span><span class="dv">28</span>, <span class="dv">512</span>)</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc2 <span class="op">=</span> nn.Linear(<span class="dv">512</span>, <span class="dv">256</span>)</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc3 <span class="op">=</span> nn.Linear(<span class="dv">256</span>, <span class="dv">128</span>)</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc4 <span class="op">=</span> nn.Linear(<span class="dv">128</span>, <span class="dv">10</span>)</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.relu <span class="op">=</span> nn.ReLU()</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dropout <span class="op">=</span> nn.Dropout(<span class="fl">0.2</span>)</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x.view(<span class="op">-</span><span class="dv">1</span>, <span class="dv">28</span><span class="op">*</span><span class="dv">28</span>)  <span class="co"># å±•å¹³</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc1(x)</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.relu(x)</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout(x)</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc2(x)</span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.relu(x)</span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout(x)</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc3(x)</span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.relu(x)</span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout(x)</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc4(x)</span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. åˆå§‹åŒ–æ¨¡å‹</span></span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>device <span class="op">=</span> torch.device(<span class="st">'cuda'</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">'cpu'</span>)</span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> DeepNN().to(device)</span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. å®šä¹‰æŸå¤±å’Œä¼˜åŒ–å™¨</span></span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>criterion <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. è®­ç»ƒå‡½æ•°</span></span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train(model, device, train_loader, optimizer, epoch):</span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>    model.train()</span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>    train_loss <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>    correct <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> batch_idx, (data, target) <span class="kw">in</span> <span class="bu">enumerate</span>(train_loader):</span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a>        data, target <span class="op">=</span> data.to(device), target.to(device)</span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>        optimizer.zero_grad()</span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a>        output <span class="op">=</span> model(data)</span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> criterion(output, target)</span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>        loss.backward()</span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a>        optimizer.step()</span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a>        train_loss <span class="op">+=</span> loss.item()</span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a>        pred <span class="op">=</span> output.argmax(dim<span class="op">=</span><span class="dv">1</span>, keepdim<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a>        correct <span class="op">+=</span> pred.eq(target.view_as(pred)).<span class="bu">sum</span>().item()</span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a>    train_loss <span class="op">/=</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> <span class="fl">100.</span> <span class="op">*</span> correct <span class="op">/</span> <span class="bu">len</span>(train_loader.dataset)</span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Epoch: </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">, Loss: </span><span class="sc">{</span>train_loss<span class="sc">:.4f}</span><span class="ss">, Accuracy: </span><span class="sc">{</span>accuracy<span class="sc">:.2f}</span><span class="ss">%'</span>)</span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> train_loss, accuracy</span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. æµ‹è¯•å‡½æ•°</span></span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test(model, device, test_loader):</span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">eval</span>()</span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true" tabindex="-1"></a>    test_loss <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true" tabindex="-1"></a>    correct <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb48-99"><a href="#cb48-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-100"><a href="#cb48-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb48-101"><a href="#cb48-101" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> data, target <span class="kw">in</span> test_loader:</span>
<span id="cb48-102"><a href="#cb48-102" aria-hidden="true" tabindex="-1"></a>            data, target <span class="op">=</span> data.to(device), target.to(device)</span>
<span id="cb48-103"><a href="#cb48-103" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> model(data)</span>
<span id="cb48-104"><a href="#cb48-104" aria-hidden="true" tabindex="-1"></a>            test_loss <span class="op">+=</span> criterion(output, target).item()</span>
<span id="cb48-105"><a href="#cb48-105" aria-hidden="true" tabindex="-1"></a>            pred <span class="op">=</span> output.argmax(dim<span class="op">=</span><span class="dv">1</span>, keepdim<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb48-106"><a href="#cb48-106" aria-hidden="true" tabindex="-1"></a>            correct <span class="op">+=</span> pred.eq(target.view_as(pred)).<span class="bu">sum</span>().item()</span>
<span id="cb48-107"><a href="#cb48-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-108"><a href="#cb48-108" aria-hidden="true" tabindex="-1"></a>    test_loss <span class="op">/=</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb48-109"><a href="#cb48-109" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> <span class="fl">100.</span> <span class="op">*</span> correct <span class="op">/</span> <span class="bu">len</span>(test_loader.dataset)</span>
<span id="cb48-110"><a href="#cb48-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-111"><a href="#cb48-111" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Test Loss: </span><span class="sc">{</span>test_loss<span class="sc">:.4f}</span><span class="ss">, Accuracy: </span><span class="sc">{</span>accuracy<span class="sc">:.2f}</span><span class="ss">%</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb48-112"><a href="#cb48-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> test_loss, accuracy</span>
<span id="cb48-113"><a href="#cb48-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-114"><a href="#cb48-114" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. è®­ç»ƒæ¨¡å‹</span></span>
<span id="cb48-115"><a href="#cb48-115" aria-hidden="true" tabindex="-1"></a>epochs <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb48-116"><a href="#cb48-116" aria-hidden="true" tabindex="-1"></a>train_losses, train_accs <span class="op">=</span> [], []</span>
<span id="cb48-117"><a href="#cb48-117" aria-hidden="true" tabindex="-1"></a>test_losses, test_accs <span class="op">=</span> [], []</span>
<span id="cb48-118"><a href="#cb48-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-119"><a href="#cb48-119" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, epochs <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb48-120"><a href="#cb48-120" aria-hidden="true" tabindex="-1"></a>    train_loss, train_acc <span class="op">=</span> train(model, device, train_loader, optimizer, epoch)</span>
<span id="cb48-121"><a href="#cb48-121" aria-hidden="true" tabindex="-1"></a>    test_loss, test_acc <span class="op">=</span> test(model, device, test_loader)</span>
<span id="cb48-122"><a href="#cb48-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-123"><a href="#cb48-123" aria-hidden="true" tabindex="-1"></a>    train_losses.append(train_loss)</span>
<span id="cb48-124"><a href="#cb48-124" aria-hidden="true" tabindex="-1"></a>    train_accs.append(train_acc)</span>
<span id="cb48-125"><a href="#cb48-125" aria-hidden="true" tabindex="-1"></a>    test_losses.append(test_loss)</span>
<span id="cb48-126"><a href="#cb48-126" aria-hidden="true" tabindex="-1"></a>    test_accs.append(test_acc)</span>
<span id="cb48-127"><a href="#cb48-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-128"><a href="#cb48-128" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹</span></span>
<span id="cb48-129"><a href="#cb48-129" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb48-130"><a href="#cb48-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-131"><a href="#cb48-131" aria-hidden="true" tabindex="-1"></a>ax1.plot(train_losses, label<span class="op">=</span><span class="st">'Train Loss'</span>)</span>
<span id="cb48-132"><a href="#cb48-132" aria-hidden="true" tabindex="-1"></a>ax1.plot(test_losses, label<span class="op">=</span><span class="st">'Test Loss'</span>)</span>
<span id="cb48-133"><a href="#cb48-133" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb48-134"><a href="#cb48-134" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb48-135"><a href="#cb48-135" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Training and Test Loss'</span>)</span>
<span id="cb48-136"><a href="#cb48-136" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb48-137"><a href="#cb48-137" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>)</span>
<span id="cb48-138"><a href="#cb48-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-139"><a href="#cb48-139" aria-hidden="true" tabindex="-1"></a>ax2.plot(train_accs, label<span class="op">=</span><span class="st">'Train Accuracy'</span>)</span>
<span id="cb48-140"><a href="#cb48-140" aria-hidden="true" tabindex="-1"></a>ax2.plot(test_accs, label<span class="op">=</span><span class="st">'Test Accuracy'</span>)</span>
<span id="cb48-141"><a href="#cb48-141" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb48-142"><a href="#cb48-142" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Accuracy (%)'</span>)</span>
<span id="cb48-143"><a href="#cb48-143" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Training and Test Accuracy'</span>)</span>
<span id="cb48-144"><a href="#cb48-144" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb48-145"><a href="#cb48-145" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>)</span>
<span id="cb48-146"><a href="#cb48-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-147"><a href="#cb48-147" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb48-148"><a href="#cb48-148" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb48-149"><a href="#cb48-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-150"><a href="#cb48-150" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. å¯è§†åŒ–ä¸€äº›é¢„æµ‹ç»“æœ</span></span>
<span id="cb48-151"><a href="#cb48-151" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">eval</span>()</span>
<span id="cb48-152"><a href="#cb48-152" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb48-153"><a href="#cb48-153" aria-hidden="true" tabindex="-1"></a>    data, target <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(test_loader))</span>
<span id="cb48-154"><a href="#cb48-154" aria-hidden="true" tabindex="-1"></a>    data, target <span class="op">=</span> data.to(device), target.to(device)</span>
<span id="cb48-155"><a href="#cb48-155" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> model(data)</span>
<span id="cb48-156"><a href="#cb48-156" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> output.argmax(dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb48-157"><a href="#cb48-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-158"><a href="#cb48-158" aria-hidden="true" tabindex="-1"></a>    <span class="co"># æ˜¾ç¤ºå‰16ä¸ªæ ·æœ¬</span></span>
<span id="cb48-159"><a href="#cb48-159" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">4</span>, <span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb48-160"><a href="#cb48-160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, ax <span class="kw">in</span> <span class="bu">enumerate</span>(axes.flat):</span>
<span id="cb48-161"><a href="#cb48-161" aria-hidden="true" tabindex="-1"></a>        image <span class="op">=</span> data[i].cpu().squeeze()</span>
<span id="cb48-162"><a href="#cb48-162" aria-hidden="true" tabindex="-1"></a>        true_label <span class="op">=</span> target[i].item()</span>
<span id="cb48-163"><a href="#cb48-163" aria-hidden="true" tabindex="-1"></a>        pred_label <span class="op">=</span> pred[i].item()</span>
<span id="cb48-164"><a href="#cb48-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-165"><a href="#cb48-165" aria-hidden="true" tabindex="-1"></a>        ax.imshow(image, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb48-166"><a href="#cb48-166" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> <span class="st">'green'</span> <span class="cf">if</span> true_label <span class="op">==</span> pred_label <span class="cf">else</span> <span class="st">'red'</span></span>
<span id="cb48-167"><a href="#cb48-167" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="ss">f'True: </span><span class="sc">{</span>true_label<span class="sc">}</span><span class="ss">, Pred: </span><span class="sc">{</span>pred_label<span class="sc">}</span><span class="ss">'</span>, color<span class="op">=</span>color)</span>
<span id="cb48-168"><a href="#cb48-168" aria-hidden="true" tabindex="-1"></a>        ax.axis(<span class="st">'off'</span>)</span>
<span id="cb48-169"><a href="#cb48-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-170"><a href="#cb48-170" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb48-171"><a href="#cb48-171" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="æœ¬ç« ä½œä¸š" class="level2">
<h2 class="anchored" data-anchor-id="æœ¬ç« ä½œä¸š">ğŸ“ æœ¬ç« ä½œä¸š</h2>
<section id="ä½œä¸š-1ç†è®ºé¢˜" class="level3">
<h3 class="anchored" data-anchor-id="ä½œä¸š-1ç†è®ºé¢˜">ä½œä¸š 1ï¼šç†è®ºé¢˜</h3>
<ol type="1">
<li><strong>æ¿€æ´»å‡½æ•°é€‰æ‹©</strong>
<ul>
<li>ä¸ºä»€ä¹ˆ ReLU æ¯” Sigmoid æ›´å¸¸ç”¨ï¼Ÿ</li>
<li>ä»€ä¹ˆæ˜¯ â€œDead ReLUâ€ é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</li>
<li>åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä»ç„¶ä½¿ç”¨ Sigmoidï¼Ÿ</li>
</ul></li>
<li><strong>åå‘ä¼ æ’­ç†è§£</strong>
<ul>
<li>ç”¨è‡ªå·±çš„è¯è§£é‡Šåå‘ä¼ æ’­</li>
<li>ä¸ºä»€ä¹ˆå«â€åå‘â€ä¼ æ’­ï¼Ÿ</li>
<li>ç”»å‡ºä¸€ä¸ª3å±‚ç½‘ç»œçš„è®¡ç®—å›¾</li>
</ul></li>
<li><strong>åˆå§‹åŒ–ç­–ç•¥</strong>
<ul>
<li>ä¸ºä»€ä¹ˆä¸èƒ½å…¨é›¶åˆå§‹åŒ–ï¼Ÿ</li>
<li>Xavier å’Œ He åˆå§‹åŒ–çš„åŒºåˆ«ï¼Ÿ</li>
<li>åç½®éœ€è¦ç‰¹æ®Šåˆå§‹åŒ–å—ï¼Ÿ</li>
</ul></li>
</ol>
</section>
<section id="ä½œä¸š-2ç¼–ç¨‹å®è·µ" class="level3">
<h3 class="anchored" data-anchor-id="ä½œä¸š-2ç¼–ç¨‹å®è·µ">ä½œä¸š 2ï¼šç¼–ç¨‹å®è·µ</h3>
<section id="ä»»åŠ¡-1ä»é›¶å®ç°å¤šå±‚ç½‘ç»œ" class="level4">
<h4 class="anchored" data-anchor-id="ä»»åŠ¡-1ä»é›¶å®ç°å¤šå±‚ç½‘ç»œ">ä»»åŠ¡ 1ï¼šä»é›¶å®ç°å¤šå±‚ç½‘ç»œ</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># å®ç°ä¸€ä¸ªLå±‚å…¨è¿æ¥ç½‘ç»œ</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DeepNeuralNetwork:</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, layer_dims):</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co">        layer_dims: æ¯å±‚çš„ç¥ç»å…ƒæ•°é‡</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co">                   ä¾‹å¦‚ [784, 128, 64, 10]</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, X):</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""å‰å‘ä¼ æ’­"""</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> backward(<span class="va">self</span>, X, Y):</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""åå‘ä¼ æ’­"""</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train(<span class="va">self</span>, X, Y, epochs, learning_rate):</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""è®­ç»ƒ"""</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">:</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. æ”¯æŒä»»æ„å±‚æ•°</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. æ”¯æŒä¸åŒæ¿€æ´»å‡½æ•°ï¼ˆReLU, Sigmoid, Tanhï¼‰</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. å®ç°æ¢¯åº¦æ£€éªŒ</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. åœ¨ MNIST ä¸Šæµ‹è¯•</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="ä»»åŠ¡-2æ¿€æ´»å‡½æ•°å¯¹æ¯”å®éªŒ" class="level4">
<h4 class="anchored" data-anchor-id="ä»»åŠ¡-2æ¿€æ´»å‡½æ•°å¯¹æ¯”å®éªŒ">ä»»åŠ¡ 2ï¼šæ¿€æ´»å‡½æ•°å¯¹æ¯”å®éªŒ</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># åœ¨ç›¸åŒæ•°æ®é›†ä¸Šå¯¹æ¯”ä¸åŒæ¿€æ´»å‡½æ•°çš„æ•ˆæœ</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Sigmoid</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Tanh</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. ReLU</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Leaky ReLU</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># è®°å½•ï¼š</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - è®­ç»ƒé€Ÿåº¦ï¼ˆè¾¾åˆ°90%å‡†ç¡®ç‡éœ€è¦çš„epochæ•°ï¼‰</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - æœ€ç»ˆå‡†ç¡®ç‡</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># - è®­ç»ƒç¨³å®šæ€§</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ç”»å‡ºè®­ç»ƒæ›²çº¿å¯¹æ¯”å›¾</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="ä»»åŠ¡-3æ·±åº¦ç½‘ç»œå®éªŒ" class="level4">
<h4 class="anchored" data-anchor-id="ä»»åŠ¡-3æ·±åº¦ç½‘ç»œå®éªŒ">ä»»åŠ¡ 3ï¼šæ·±åº¦ç½‘ç»œå®éªŒ</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># åœ¨ Fashion-MNIST ä¸Šå¯¹æ¯”ä¸åŒæ·±åº¦çš„ç½‘ç»œ</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 2å±‚ï¼š784 â†’ 128 â†’ 10</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 3å±‚ï¼š784 â†’ 256 â†’ 128 â†’ 10</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 4å±‚ï¼š784 â†’ 512 â†’ 256 â†’ 128 â†’ 10</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 5å±‚ï¼š784 â†’ 512 â†’ 256 â†’ 128 â†’ 64 â†’ 10</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># åˆ†æï¼š</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - æ˜¯å¦è¶Šæ·±è¶Šå¥½ï¼Ÿ</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - è§‚å¯Ÿæ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸ç°è±¡</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># - å°è¯•ä¸åŒçš„åˆå§‹åŒ–æ–¹æ³•</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
</section>
<section id="æœ¬ç« å…³é”®æ¦‚å¿µ" class="level2">
<h2 class="anchored" data-anchor-id="æœ¬ç« å…³é”®æ¦‚å¿µ">ğŸ”‘ æœ¬ç« å…³é”®æ¦‚å¿µ</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>æ¦‚å¿µ</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ç¥ç»ç½‘ç»œ</td>
<td>å¤šå±‚æ„ŸçŸ¥æœºçš„å †å </td>
</tr>
<tr class="even">
<td>å‰å‘ä¼ æ’­</td>
<td>ä»è¾“å…¥è®¡ç®—åˆ°è¾“å‡º</td>
</tr>
<tr class="odd">
<td>åå‘ä¼ æ’­</td>
<td>ç”¨é“¾å¼æ³•åˆ™è®¡ç®—æ¢¯åº¦</td>
</tr>
<tr class="even">
<td>æ¿€æ´»å‡½æ•°</td>
<td>å¼•å…¥éçº¿æ€§</td>
</tr>
<tr class="odd">
<td>ReLU</td>
<td>æœ€å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°</td>
</tr>
<tr class="even">
<td>Sigmoid</td>
<td>è¾“å‡ºå±‚ï¼ˆäºŒå…ƒåˆ†ç±»ï¼‰</td>
</tr>
<tr class="odd">
<td>Softmax</td>
<td>è¾“å‡ºå±‚ï¼ˆå¤šå…ƒåˆ†ç±»ï¼‰</td>
</tr>
<tr class="even">
<td>Xavieråˆå§‹åŒ–</td>
<td>é€‚ç”¨äº Sigmoid/Tanh</td>
</tr>
<tr class="odd">
<td>Heåˆå§‹åŒ–</td>
<td>é€‚ç”¨äº ReLU</td>
</tr>
<tr class="even">
<td>æ¢¯åº¦æ£€éªŒ</td>
<td>éªŒè¯åå‘ä¼ æ’­æ­£ç¡®æ€§</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="ä¸‹ä¸€ç« é¢„å‘Š" class="level2">
<h2 class="anchored" data-anchor-id="ä¸‹ä¸€ç« é¢„å‘Š">ğŸ¯ ä¸‹ä¸€ç« é¢„å‘Š</h2>
<p><strong>ç¬¬äº”ç« ï¼šä¼˜åŒ–ç®—æ³•ä¸è®­ç»ƒæŠ€å·§</strong> - Mini-batch æ¢¯åº¦ä¸‹é™ - åŠ¨é‡ (Momentum) - RMSprop, Adam - Learning Rate Scheduling - Batch Normalization - Dropout - æ­£åˆ™åŒ–æŠ€æœ¯ - è°ƒå‚æŠ€å·§</p>
<hr>
<hr>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter3.html" class="pagination-link" aria-label="ç¬¬ä¸‰ç« ï¼šåˆ†ç±»ä¸é€»è¾‘å›å½’ (Classification &amp; Logistic Regression)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">ç¬¬ä¸‰ç« ï¼šåˆ†ç±»ä¸é€»è¾‘å›å½’ (Classification &amp; Logistic Regression)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter5.html" class="pagination-link" aria-label="ç¬¬äº”ç« ï¼šä¼˜åŒ–ç®—æ³•ä¸è®­ç»ƒæŠ€å·§ (Optimization &amp; Training Tricks)">
        <span class="nav-page-text"><span class="chapter-title">ç¬¬äº”ç« ï¼šä¼˜åŒ–ç®—æ³•ä¸è®­ç»ƒæŠ€å·§ (Optimization &amp; Training Tricks)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>